{"version":3,"file":"main.js","mappings":"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","sources":["webpack://demo/../../node_modules/@wsdot/layer-metadata-soe-client/index.js","webpack://demo/./src/FormatError.ts","webpack://demo/./src/GithubLink.ts","webpack://demo/./src/no-webmap-app/configSelector.ts","webpack://demo/./src/no-webmap-app/config/main.ts","webpack://demo/../../node_modules/tslib/tslib.es6.js","webpack://demo/../grouped-layer-list/dist/LayerSettings.js","webpack://demo/../grouped-layer-list/dist/conversionUtils.js","webpack://demo/../grouped-layer-list/dist/main.js","webpack://demo/../grouped-layer-list/dist/metadataUtils.js","webpack://demo/../grouped-layer-list/dist/reUtils.js","webpack://demo/../grouped-layer-list/dist/searchUtils.js","webpack://demo/external amd \"dijit/layout/BorderContainer\"","webpack://demo/external amd \"dijit/layout/ContentPane\"","webpack://demo/external amd \"esri/config\"","webpack://demo/external amd \"esri/dijit/HomeButton\"","webpack://demo/external amd \"esri/dijit/LayerList\"","webpack://demo/external amd \"esri/geometry/Extent\"","webpack://demo/external amd \"esri/geometry/webMercatorUtils\"","webpack://demo/external amd \"esri/layers/ArcGISDynamicMapServiceLayer\"","webpack://demo/external amd \"esri/layers/ArcGISTiledMapServiceLayer\"","webpack://demo/external amd \"esri/map\"","webpack://demo/webpack/bootstrap","webpack://demo/webpack/runtime/define property getters","webpack://demo/webpack/runtime/hasOwnProperty shorthand","webpack://demo/webpack/runtime/make namespace object","webpack://demo/./src/no-webmap-app/main.ts"],"sourcesContent":["\"use strict\";\r\n/// <reference lib=\"dom\" />\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * @package @wsdot/layer-metadata-soe-client\r\n */\r\n/** @ignore */\r\nvar validLayersUrl = \"exts/LayerMetadata/validLayers?f=json\";\r\n/** @ignore */\r\nvar layerSourcesUrl = \"exts/LayerMetadata/layerSources?f=json\";\r\n/** @ignore */\r\nvar metadataUrl = \"exts/LayerMetadata/metadata\";\r\n/**\r\n * An error returned from an ArcGIS service.\r\n * @example\r\n * // Inside async function\r\n * const response = await fetch(\"https://www.example.com/ArcGIS/rest/services/MyService/query?invalidOption=thisisinvalid\");\r\n * const obj = await response.json();\r\n * if (obj.error) {\r\n *  throw new ArcGisError(obj.error);\r\n * }\r\n */\r\nvar ArcGisError = /** @class */ (function (_super) {\r\n    __extends(ArcGisError, _super);\r\n    /**\r\n     * Creates a new instance of ArcGisError.\r\n     * @param errorInfo - The \"error\" property of the response object returned from a failed ArcGIS Server request.\r\n     */\r\n    function ArcGisError(errorInfo) {\r\n        var _this = _super.call(this, errorInfo.message) || this;\r\n        _this.errorInfo = errorInfo;\r\n        _this.code = errorInfo.code;\r\n        return _this;\r\n    }\r\n    return ArcGisError;\r\n}(Error));\r\nexports.ArcGisError = ArcGisError;\r\n/**\r\n * Gets map service info\r\n * @param serviceUrl map service URL.\r\n * @throws {ArcGisError}\r\n */\r\nfunction getServiceInfo(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var response, serviceInfo;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, fetch([serviceUrl, \"f=json\"].join(\"?\"))];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    serviceInfo = (_a.sent());\r\n                    if (serviceInfo.error) {\r\n                        throw new ArcGisError(serviceInfo.error);\r\n                    }\r\n                    return [2 /*return*/, serviceInfo];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getServiceInfo = getServiceInfo;\r\n/**\r\n * Detects if a map service supports the \"LayerMetadata\" capability.\r\n * @param serviceUrl Map or Feature service URL.\r\n * @throws {ArcGisError}\r\n */\r\nfunction detectLayerMetadataSupport(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var serviceInfo;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, getServiceInfo(serviceUrl)];\r\n                case 1:\r\n                    serviceInfo = _a.sent();\r\n                    if (!serviceInfo.supportedExtensions) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    return [2 /*return*/, /LayerMetadata/.test(serviceInfo.supportedExtensions)];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.detectLayerMetadataSupport = detectLayerMetadataSupport;\r\n/**\r\n * Gets a list of data sources\r\n * @param serviceUrl Map service URL\r\n * @returns An object keyed by data set names with values that are layer ID integers associated with those datasets.\r\n */\r\nfunction getLayerSources(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var url, response, layerSources;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    url = [serviceUrl, layerSourcesUrl].join(\"/\");\r\n                    return [4 /*yield*/, fetch(url)];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    layerSources = (_a.sent());\r\n                    return [2 /*return*/, layerSources];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getLayerSources = getLayerSources;\r\n/**\r\n * Gets URLs to unique metadata items.\r\n * @param url map service URL\r\n * @param layerSources If you have already called getLayerSources, you can pass in the results here to avoid making a duplicate request.\r\n * @returns Key value pairs. Keys are table names and values are metadata URLs.\r\n */\r\nfunction getMetadataLinks(url, layerSources) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var requestUrl, output, key;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!!layerSources) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, getLayerSources(url)];\r\n                case 1:\r\n                    layerSources = _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    requestUrl = [url, metadataUrl].join(\"/\");\r\n                    output = {};\r\n                    // tslint:disable-next-line:forin\r\n                    for (key in layerSources) {\r\n                        output[key] = [requestUrl, layerSources[key][0]].join(\"/\");\r\n                    }\r\n                    return [2 /*return*/, output];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getMetadataLinks = getMetadataLinks;\r\n/**\r\n * Gets a list of valid layer IDs\r\n * @param url Map service URL\r\n * @throws {ArcGisError} Thrown if the map service returns an error.\r\n * @throws {TypeError} Thrown if HTTP request returns an object in unexpected format.\r\n */\r\nfunction getValidLayers(url) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var requestUrl, response, obj;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    requestUrl = [url, validLayersUrl].join(\"/\");\r\n                    return [4 /*yield*/, fetch(requestUrl)];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    obj = _a.sent();\r\n                    if (obj.layerIds) {\r\n                        return [2 /*return*/, obj.layerIds];\r\n                    }\r\n                    else if (obj.error) {\r\n                        throw new ArcGisError(obj.error);\r\n                    }\r\n                    else {\r\n                        throw new TypeError(\"response was not expected type: \" + JSON.stringify(obj));\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getValidLayers = getValidLayers;\r\n","/**\r\n * An error to be used when a string is not in the format that was expected.\r\n */\r\nexport class FormatError extends Error {\r\n  /**\r\n   * Creates a new instance\r\n   * @param value The string that generated the error.\r\n   * @param expectedFormat The format that was expected.\r\n   */\r\n  constructor(value: string, expectedFormat: RegExp) {\r\n    super(`\"${value}\" does not match expected format: \"${expectedFormat}\".`);\r\n  }\r\n}\r\n","import { FormatError } from \"./FormatError\";\r\n\r\n/**\r\n * Gets the Github.com URL for a URL of a page published via Github Pages.\r\n * @param url Github Pages URL. If omitted, location.href will be used.\r\n * @throws {FormatError}\r\n */\r\nexport function ghPagesToGithubUrl(url: string = location.href) {\r\n  const re = /https?\\:\\/\\/([^\\.]+)\\.github.io\\/([^\\/]+)/i;\r\n  const match = url.match(re);\r\n  if (!match) {\r\n    throw new FormatError(url, re);\r\n  }\r\n\r\n  const [, owner, project] = match;\r\n  return `https://www.github.com/${owner}/${project}`;\r\n}\r\n\r\n/**\r\n * Converts a GitHub repository page URL into a Github Pages URL.\r\n * (Does not check to see if URL actually exists.)\r\n * @param url Github repository URL. If omitted, location.href will be used.\r\n * @throws {FormatError}\r\n */\r\nexport function githubToGHPagesUrl(url: string = location.href) {\r\n  const re = /https?\\:\\/\\/www.github.com\\/([^\\/]+)\\/([^\\/]+)/;\r\n  const match = url.match(re);\r\n  if (!match) {\r\n    throw new FormatError(url, re);\r\n  }\r\n\r\n  const [, owner, project] = match;\r\n  return `https://${owner}.github.io/${project}`;\r\n}\r\n\r\n/**\r\n * Creates a link to the source code on Github for a Github Pages page.\r\n * (Does not check to see if URL actually exists.)\r\n * @param url Github repository URL. If omitted and page is hosted on Github Pages, the GitHub project URL will be automatically detected.\r\n * @returns An anchor (a) element that will link to a GitHub project. The anchor element will be labelled with a span element.\r\n * The anchor has the class \"github-link\" and the child span will have the class \"github-link__label\" (following BEM convention).\r\n */\r\nexport function createSourceLink(url?: string) {\r\n  url = url || ghPagesToGithubUrl();\r\n\r\n  const a = document.createElement(\"a\");\r\n  a.href = url;\r\n  a.target = \"_blank\";\r\n  a.rel = \"nofollow\";\r\n\r\n  const span = document.createElement(\"span\");\r\n  span.textContent = \"Source on GitHub\";\r\n\r\n  a.classList.add(\"github-link\");\r\n  span.classList.add(\"github-link__label\");\r\n\r\n  a.appendChild(span);\r\n\r\n  return a;\r\n}\r\n","import configs from \"./config/main\";\r\n\r\n// function emitEvent(this: HTMLSelectElement, ev: Event) {\r\n//   const option = this.selectedOptions[0];\r\n//   const configName = option.value;\r\n//   const config = (configs as any)[configName];\r\n//   const { layers } = config;\r\n//   const outEvent = new CustomEvent(\"configselect\", { detail: layers });\r\n//   this.dispatchEvent(outEvent);\r\n// }\r\n\r\nexport function createConfigSelector() {\r\n  const docFrag = document.createDocumentFragment();\r\n  let option = document.createElement(\"option\");\r\n  option.text = \"Select a config\";\r\n  option.selected = true;\r\n  option.disabled = true;\r\n  docFrag.appendChild(option);\r\n  for (const configName in configs) {\r\n    if (configs.hasOwnProperty(configName)) {\r\n      const config = (configs as any)[configName];\r\n      const title: string = config.pageTitle;\r\n      option = document.createElement(\"option\");\r\n      option.value = configName;\r\n      option.text = option.label = title || configName;\r\n      docFrag.appendChild(option);\r\n    }\r\n  }\r\n  const select = document.createElement(\"select\");\r\n  select.appendChild(docFrag);\r\n  select.name = \"config\";\r\n\r\n  const form = document.createElement(\"form\");\r\n  form.action = location.href;\r\n  form.appendChild(select);\r\n  form.classList.add(\"config-select\");\r\n\r\n  select.addEventListener(\"change\", () => {\r\n    form.submit();\r\n  });\r\n\r\n  return form;\r\n}\r\n","import airport from \"./airport.json\";\r\nimport config from \"./config.json\";\r\nimport crmp from \"./crmp.json\";\r\nimport fishPassageBarriers from \"./fish-passage-barriers.json\";\r\nimport functionalClass from \"./FunctionalClass.json\";\r\nimport traffic from \"./traffic.json\";\r\n\r\nconst output = {\r\n  airport,\r\n  config,\r\n  crmp,\r\n  fishPassageBarriers,\r\n  functionalClass,\r\n  traffic\r\n};\r\n\r\nexport default output;\r\n\r\nexport function getConfigLayers(configName: string) {\r\n  return (output as any)[configName];\r\n}\r\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LayerSettings = void 0;\r\nvar reUtils_1 = require(\"./reUtils\");\r\n/**\r\n * Stores settings for individual layers.\r\n */\r\nvar LayerSettings = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance\r\n     * @param options An object that implements ILayerSettings.\r\n     */\r\n    function LayerSettings(options) {\r\n        if (options) {\r\n            this.visible = options.visible;\r\n            this.visibleLayers = options.visibleLayers;\r\n        }\r\n    }\r\n    /**\r\n     * Converts a string from a URLSearchParams value into a LayerSettings.\r\n     * @param str a value from a URLSearchParams.\r\n     */\r\n    LayerSettings.parse = function (str) {\r\n        var trueRe = (0, reUtils_1.makeBooleanRe)(true, false);\r\n        var falseRe = (0, reUtils_1.makeBooleanRe)(false, false);\r\n        var sublayersRe = /\\-?\\d+/g; // matches all instances of integers in a string.\r\n        var visible = trueRe.test(str)\r\n            ? true\r\n            : falseRe.test(str)\r\n                ? false\r\n                : undefined;\r\n        var visibleLayers;\r\n        var sublayersMatch = str.match(sublayersRe);\r\n        if (sublayersMatch) {\r\n            visibleLayers = sublayersMatch.map(function (s) { return parseInt(s, 10); });\r\n        }\r\n        if (visible === undefined && visibleLayers) {\r\n            visible = true;\r\n        }\r\n        if (visible === null) {\r\n            return null;\r\n        }\r\n        var layerSettings = new LayerSettings({\r\n            visible: visible,\r\n            visibleLayers: visibleLayers\r\n        });\r\n        return layerSettings;\r\n    };\r\n    /**\r\n     * Applies the settings to an operational layer.\r\n     * @param operationalLayer An operational layer from a layer list.\r\n     */\r\n    LayerSettings.prototype.apply = function (operationalLayer) {\r\n        var layer = operationalLayer.layer;\r\n        if (!layer) {\r\n            return;\r\n        }\r\n        // TypeScript cast to more specific type to allow check for\r\n        // suspend and resume functions.\r\n        var refreshAbleLayer = layer;\r\n        // Suspend drawing operations until all layer properties are set.\r\n        if (refreshAbleLayer.suspend) {\r\n            refreshAbleLayer.suspend();\r\n        }\r\n        if (this.visible != null) {\r\n            operationalLayer.visibility = this.visible;\r\n            layer.setVisibility(this.visible);\r\n        }\r\n        if (operationalLayer.showSubLayers !== false &&\r\n            this.visibleLayers &&\r\n            refreshAbleLayer.setVisibleLayers) {\r\n            refreshAbleLayer.setVisibleLayers(this.visibleLayers);\r\n        }\r\n        // Resume layer drawing.\r\n        if (refreshAbleLayer.resume) {\r\n            refreshAbleLayer.resume();\r\n        }\r\n    };\r\n    /**\r\n     * Converts to string for use with URLSearchParams\r\n     */\r\n    LayerSettings.prototype.toString = function () {\r\n        var checked = \"\";\r\n        var unchecked = \"\";\r\n        var checkedState = this.visible == null ? \"\" : this.visible ? checked : unchecked;\r\n        // const visibleLayers = this.visibleLayers\r\n        //   ? this.visibleLayers.join(\" \")\r\n        //   : \"\";\r\n        // return visibleLayers ? `${checkedState} ${visibleLayers}`\r\n        if (this.visibleLayers) {\r\n            return [checkedState]\r\n                .concat(this.visibleLayers.map(function (n) { return n.toString(10); }))\r\n                .join(\" \");\r\n        }\r\n        return checkedState;\r\n    };\r\n    return LayerSettings;\r\n}());\r\nexports.LayerSettings = LayerSettings;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.fromGeoportalLayers = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar ArcGISDynamicMapServiceLayer_1 = tslib_1.__importDefault(require(\"esri/layers/ArcGISDynamicMapServiceLayer\"));\r\nvar ArcGISTiledMapServiceLayer_1 = tslib_1.__importDefault(require(\"esri/layers/ArcGISTiledMapServiceLayer\"));\r\n/**\r\n * Creates an operational layer from a GeoPortal config file layer definition.\r\n * @param configLayer GeoPortal config file layer definition\r\n * @returns a LayerList operational layer.\r\n */\r\nfunction configLayerToOpLayer(configLayer) {\r\n    var layerType = configLayer.layerType, url = configLayer.url;\r\n    var title = configLayer.options.id;\r\n    // Replace non-alphanumeric characters with underscore.\r\n    var id = title.replace(/[^a-z0-9]+/gi, \"_\");\r\n    var visible = configLayer.options.visible || false;\r\n    var opacity = configLayer.options.opacity;\r\n    // Create layer object matching layerType string.\r\n    var layer = /Tiled/i.test(layerType)\r\n        ? new ArcGISTiledMapServiceLayer_1.default(url, { id: id, visible: visible, opacity: opacity })\r\n        : new ArcGISDynamicMapServiceLayer_1.default(url, { id: id, visible: visible, opacity: opacity });\r\n    var opLayer = {\r\n        id: id,\r\n        layer: layer,\r\n        showLegend: true,\r\n        showOpacitySlider: true,\r\n        title: title,\r\n        visibility: visible\r\n    };\r\n    return opLayer;\r\n}\r\n/**\r\n * Creates operational layers and group definition from GeoPortal config \"layers\" section.\r\n * @param configLayers \"layers\" value from GeoPortal config.\r\n */\r\nfunction fromGeoportalLayers(configLayers) {\r\n    var layers;\r\n    var groups;\r\n    if (Array.isArray(configLayers)) {\r\n        layers = configLayers.map(configLayerToOpLayer);\r\n        return { groups: groups, layers: layers };\r\n    }\r\n    layers = new Array();\r\n    groups = {};\r\n    for (var groupName in configLayers) {\r\n        if (configLayers.hasOwnProperty(groupName)) {\r\n            var layersOfGroup = configLayers[groupName];\r\n            var opLayers = layersOfGroup.map(configLayerToOpLayer);\r\n            opLayers.forEach(function (l) { return layers.push(l); });\r\n            groups[groupName] = opLayers.map(function (ol) { return ol.title; });\r\n        }\r\n    }\r\n    return { groups: groups, layers: layers };\r\n}\r\nexports.fromGeoportalLayers = fromGeoportalLayers;\r\n","\"use strict\";\r\n/**\r\n * Exposes GroupLayerList class and related functions.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.convertLayer = exports.getGroupsFromCreateMapItem = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar LayerList_1 = tslib_1.__importDefault(require(\"esri/dijit/LayerList\"));\r\nvar metadataUtils_1 = require(\"./metadataUtils\");\r\ntslib_1.__exportStar(require(\"./searchUtils\"), exports);\r\ntslib_1.__exportStar(require(\"./conversionUtils\"), exports);\r\n/**\r\n * Gets layer group definition (if present) from a web map.\r\n * @param itemInfo\r\n */\r\nfunction getGroupsFromCreateMapItem(itemInfo) {\r\n    if (itemInfo.itemData.applicationProperties) {\r\n        var applicationProperties = itemInfo.itemData.applicationProperties;\r\n        if (applicationProperties.viewing) {\r\n            var viewing = applicationProperties.viewing;\r\n            if (viewing.layerGrouping) {\r\n                var layerGrouping = viewing.layerGrouping;\r\n                if (layerGrouping && layerGrouping.enabled && layerGrouping.groups) {\r\n                    return layerGrouping.groups;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexports.getGroupsFromCreateMapItem = getGroupsFromCreateMapItem;\r\n/**\r\n * Converts the operational layer format returned from arcgis/utils.createMap to the\r\n * operation layer format expected by the LayerList constructor.\r\n * @param opLayer Operational layer object from arcgis/utils.createMap complete event.\r\n * @returns Operational layer for use with the LayerList constructor.\r\n */\r\nfunction convertLayer(opLayer) {\r\n    var id = opLayer.id, title = opLayer.title, visibility = opLayer.visibility;\r\n    var showLegend = true;\r\n    var showOpacitySlider = true;\r\n    var layer = opLayer.layerObject;\r\n    // Don't show sublayers tab if there is only one sublayer. Otherwise, show it.\r\n    var showSubLayers = layer.layerInfos\r\n        ? layer.layerInfos.length > 1\r\n        : true;\r\n    return {\r\n        id: id,\r\n        title: title,\r\n        layer: layer,\r\n        visibility: visibility,\r\n        showLegend: showLegend,\r\n        showOpacitySlider: showOpacitySlider,\r\n        showSubLayers: showSubLayers\r\n    };\r\n}\r\nexports.convertLayer = convertLayer;\r\n/**\r\n * Enumerate through the layers in the order presented in the grouping object.\r\n * @param titleGroups Grouping of layers\r\n * @param layers Array of layers\r\n * @param propertyName The name of the property. (Defaults to \"id\")\r\n * @param throwOnValueNotFound Set to true to throw a ReferenceError if a\r\n * group has a value that has no matching layer. If set to false, the invalid\r\n * value will simply be ignored.\r\n * @throws ReferenceError thrown if titleGroups contains a value that has no\r\n * corresponding layer when throwOnValueNotFound is true.\r\n * @yields {LayerListOperationalLayer}\r\n */\r\nfunction enumerateLayersInGroupOrder(titleGroups, layers, propertyName, throwOnValueNotFound) {\r\n    var _a, _b, _i, groupName, titles, _loop_1, titles_1, titles_1_1, title, e_1_1;\r\n    var e_1, _c;\r\n    if (propertyName === void 0) { propertyName = \"id\"; }\r\n    return tslib_1.__generator(this, function (_d) {\r\n        switch (_d.label) {\r\n            case 0:\r\n                _a = [];\r\n                for (_b in titleGroups)\r\n                    _a.push(_b);\r\n                _i = 0;\r\n                _d.label = 1;\r\n            case 1:\r\n                if (!(_i < _a.length)) return [3 /*break*/, 10];\r\n                groupName = _a[_i];\r\n                if (!titleGroups.hasOwnProperty(groupName)) return [3 /*break*/, 9];\r\n                titles = titleGroups[groupName];\r\n                _loop_1 = function (title) {\r\n                    var layer, msg;\r\n                    return tslib_1.__generator(this, function (_e) {\r\n                        switch (_e.label) {\r\n                            case 0:\r\n                                layer = layers.find(function (l) { return l[propertyName] === title; });\r\n                                if (!layer) {\r\n                                    msg = \"No layer found with \\\"\".concat(propertyName, \"\\\" of \\\"\").concat(title, \"\\\".\");\r\n                                    if (throwOnValueNotFound) {\r\n                                        throw new ReferenceError(msg);\r\n                                    }\r\n                                    else {\r\n                                        console.warn(msg);\r\n                                        return [2 /*return*/, \"continue\"];\r\n                                    }\r\n                                }\r\n                                return [4 /*yield*/, layer];\r\n                            case 1:\r\n                                _e.sent();\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                };\r\n                _d.label = 2;\r\n            case 2:\r\n                _d.trys.push([2, 7, 8, 9]);\r\n                titles_1 = (e_1 = void 0, tslib_1.__values(titles)), titles_1_1 = titles_1.next();\r\n                _d.label = 3;\r\n            case 3:\r\n                if (!!titles_1_1.done) return [3 /*break*/, 6];\r\n                title = titles_1_1.value;\r\n                return [5 /*yield**/, _loop_1(title)];\r\n            case 4:\r\n                _d.sent();\r\n                _d.label = 5;\r\n            case 5:\r\n                titles_1_1 = titles_1.next();\r\n                return [3 /*break*/, 3];\r\n            case 6: return [3 /*break*/, 9];\r\n            case 7:\r\n                e_1_1 = _d.sent();\r\n                e_1 = { error: e_1_1 };\r\n                return [3 /*break*/, 9];\r\n            case 8:\r\n                try {\r\n                    if (titles_1_1 && !titles_1_1.done && (_c = titles_1.return)) _c.call(titles_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n                return [7 /*endfinally*/];\r\n            case 9:\r\n                _i++;\r\n                return [3 /*break*/, 1];\r\n            case 10: return [2 /*return*/];\r\n        }\r\n    });\r\n}\r\n/**\r\n * Creates a mapping of layer titles to group names.\r\n * @param groups group definition object.\r\n */\r\nfunction createTitleToGroupMapping(groups) {\r\n    var mapping = new Map();\r\n    var _loop_2 = function (groupName) {\r\n        if (groups.hasOwnProperty(groupName)) {\r\n            var layerNames = groups[groupName];\r\n            layerNames.forEach(function (ln) { return mapping.set(ln, groupName); });\r\n        }\r\n    };\r\n    for (var groupName in groups) {\r\n        _loop_2(groupName);\r\n    }\r\n    return mapping;\r\n}\r\n/**\r\n * Adds group headings above the list item corresponding to the first layer\r\n * in a group.\r\n * @param srcNode the srcNode of a LayerList\r\n * @param groups Defines which layers are in which group.\r\n * @returns CSS text to be added to a style element to be added to the page head.\r\n */\r\nfunction addGroupHeadings(srcNode, groups) {\r\n    // srcNode can be defined as either a node's \"id\" or the node itself.\r\n    // Get the HTMLElement.\r\n    var rootNode = typeof srcNode === \"string\"\r\n        ? document.getElementById(srcNode)\r\n        : srcNode;\r\n    // Get the root node by ID in control creation changed node root to different node type\r\n    // and is no longer using the input root node.\r\n    if (rootNode.id) {\r\n        rootNode = document.getElementById(rootNode.id) || rootNode;\r\n    }\r\n    // Get all of the <li> elements that correspond to map layers.\r\n    var listItems = rootNode.querySelectorAll(\".esriList > li\");\r\n    // Create layer title-to-group mapping.\r\n    var mapping = createTitleToGroupMapping(groups);\r\n    // Initialize variable to hold previous group name from previous loop iteration.\r\n    var previousGroupName;\r\n    // Define a common css class for all list items that begin a group.\r\n    var groupStartClass = \"layer-list-group-start\";\r\n    // Initialize group counter\r\n    var groupNo = 0;\r\n    // Initialize CSS class name to group name mapping.\r\n    var classToGroupNameMapping = new Map();\r\n    // Assign CSS classes to the <li>s corresponding to the first layer in a group.\r\n    // For each such item, add item to the class-to-group mapping.\r\n    Array.from(listItems, function (li) {\r\n        var label = li.querySelector(\"label\");\r\n        if (label) {\r\n            var title = label.textContent;\r\n            var groupName = mapping.get(title) || \"Other\";\r\n            if (groupName !== previousGroupName) {\r\n                var className = \"layer-list-group-\".concat(groupNo);\r\n                classToGroupNameMapping.set(className, groupName);\r\n                li.classList.add(groupStartClass, className);\r\n                groupNo++;\r\n            }\r\n            previousGroupName = groupName;\r\n        }\r\n    });\r\n    // Create the CSS definition.\r\n    var cssText = Array.from(classToGroupNameMapping, function (_a) {\r\n        var _b = tslib_1.__read(_a, 2), className = _b[0], groupName = _b[1];\r\n        return \".\".concat(className, \":before { content: '\").concat(groupName, \"' }\");\r\n    });\r\n    return cssText.join(\"\\n\");\r\n}\r\n/**\r\n * An extension of esri/dijit/LayerList that supports grouping.\r\n */\r\nvar GroupedLayerList = /** @class */ (function (_super) {\r\n    tslib_1.__extends(GroupedLayerList, _super);\r\n    function GroupedLayerList(options, srcNode) {\r\n        var _this = this;\r\n        // If options.groups is defined, sort the layers to match group definition\r\n        if (options.groups) {\r\n            var originLayers = options.layers;\r\n            var sortedLayers_1 = new (Array.bind.apply(Array, tslib_1.__spreadArray([void 0], tslib_1.__read(enumerateLayersInGroupOrder(options.groups, options.layers, options.groupProperty, options.throwOnGroupNotFound)), false)))();\r\n            // Append any layers that are not listed in the grouping object.\r\n            originLayers\r\n                .filter(function (l) { return !sortedLayers_1.includes(l); })\r\n                .forEach(function (l) { return sortedLayers_1.push(l); });\r\n            // Change the layers' order to match the group object.\r\n            options.layers = sortedLayers_1.reverse();\r\n        }\r\n        // Get the \"id\" of the srcNode.\r\n        var nodeId = srcNode === \"string\"\r\n            ? srcNode\r\n            : srcNode instanceof HTMLElement\r\n                ? srcNode.id\r\n                : null;\r\n        _this = _super.call(this, options, srcNode) || this;\r\n        // Get the node \"id\" if one was autogenerated.\r\n        _this._nodeId =\r\n            nodeId || typeof srcNode === \"string\"\r\n                ? srcNode\r\n                : srcNode.id;\r\n        if (options.groups) {\r\n            _this.on(\"load\", function (evt) {\r\n                // Add group headers to the first layer's <li> using CSS :before pseudo-element.\r\n                var cssText = addGroupHeadings(srcNode, options.groups);\r\n                var styleNode = document.createElement(\"style\");\r\n                styleNode.textContent = cssText;\r\n                document.head.appendChild(styleNode);\r\n            });\r\n        }\r\n        if (options.metadata) {\r\n            (0, metadataUtils_1.addMetadataTabs)(_this, options.metadataOptions);\r\n        }\r\n        return _this;\r\n    }\r\n    Object.defineProperty(GroupedLayerList.prototype, \"root\", {\r\n        /**\r\n         * Gets the element that is hosting the control.\r\n         */\r\n        get: function () {\r\n            return document.getElementById(this._nodeId);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return GroupedLayerList;\r\n}(LayerList_1.default));\r\nexports.default = GroupedLayerList;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.addMetadataTabs = exports.MetadataOptions = exports.isSoeMetadataUrl = exports.MetadataSourceEnum = exports.defaultFormatterPage = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar layer_metadata_soe_client_1 = require(\"@wsdot/layer-metadata-soe-client\");\r\nexports.defaultFormatterPage = \"https://wsdot-gis.github.io/geospatial-metadata\";\r\nvar MetadataSourceEnum;\r\n(function (MetadataSourceEnum) {\r\n    MetadataSourceEnum[MetadataSourceEnum[\"None\"] = 0] = \"None\";\r\n    MetadataSourceEnum[MetadataSourceEnum[\"BuiltIn\"] = 1] = \"BuiltIn\";\r\n    MetadataSourceEnum[MetadataSourceEnum[\"Soe\"] = 2] = \"Soe\";\r\n    MetadataSourceEnum[MetadataSourceEnum[\"Both\"] = 3] = \"Both\"; // BuiltIn | Soe\r\n})(MetadataSourceEnum = exports.MetadataSourceEnum || (exports.MetadataSourceEnum = {}));\r\n/**\r\n * Detects if a metadata URL is a WSDOT custom LayerMetadata SOE URL.\r\n * @param url metadata URL\r\n * @returns Returns true if URL contains \"exts/LayerMetadata\", false otherwise.\r\n */\r\nfunction isSoeMetadataUrl(url) {\r\n    var re = /\\bexts\\/LayerMetadata\\b/gi;\r\n    return re.test(url instanceof URL ? url.href : url);\r\n}\r\nexports.isSoeMetadataUrl = isSoeMetadataUrl;\r\n/**\r\n * Creates a URL for a page that formats a metadata URL's XML into HTML.\r\n * @param metadataUrl Metadata URL.\r\n * @param options Controls how the metadata will be formatted.\r\n * @returns output URL\r\n */\r\nfunction wrapUrlWithFormatterPage(metadataUrl, options) {\r\n    var formatterPageUrl = options.formatterPageUrl, format = options.format, output = options.output, whatToFormat = options.whatToFormat;\r\n    var isSoe = isSoeMetadataUrl(metadataUrl);\r\n    if (!(metadataUrl instanceof URL)) {\r\n        metadataUrl = new URL(metadataUrl);\r\n    }\r\n    function shouldWrap() {\r\n        if (!formatterPageUrl) {\r\n            console.groupEnd();\r\n            return false;\r\n        }\r\n        // Set whatToFormat to None if undefined.\r\n        if (whatToFormat == null) {\r\n            whatToFormat = MetadataSourceEnum.None;\r\n        }\r\n        var shouldWrap;\r\n        if (isSoe) {\r\n            shouldWrap = (whatToFormat & MetadataSourceEnum.Soe) === MetadataSourceEnum.Soe;\r\n            ;\r\n            console.debug(\"Current URL is an SOE. Should wrap? \".concat(shouldWrap));\r\n        }\r\n        else {\r\n            shouldWrap = (whatToFormat & MetadataSourceEnum.BuiltIn) === MetadataSourceEnum.BuiltIn;\r\n        }\r\n        console.groupEnd();\r\n        return shouldWrap;\r\n    }\r\n    var outUrl;\r\n    if (shouldWrap() && formatterPageUrl) {\r\n        outUrl = new URL(formatterPageUrl);\r\n        var paramUrl = new URL(metadataUrl);\r\n        if (!isSoe) {\r\n            // For the wrapper page, the output will need to be XML, so remove \"output\" parameter\r\n            paramUrl.searchParams.delete(\"output\");\r\n            if (format) {\r\n                paramUrl.searchParams.set(\"format\", format);\r\n            }\r\n        }\r\n        else {\r\n            paramUrl.searchParams.set(\"f\", \"xml\");\r\n        }\r\n        outUrl.searchParams.set(\"url\", paramUrl.href);\r\n    }\r\n    else { // Unwrapped\r\n        outUrl = new URL(metadataUrl);\r\n        if (!isSoe) {\r\n            console.debug(\"is not an SOE\");\r\n            if (output) {\r\n                outUrl.searchParams.set(\"output\", output);\r\n            }\r\n            if (format) {\r\n                outUrl.searchParams.set(\"format\", format);\r\n            }\r\n        }\r\n        else if (output !== \"html\") {\r\n            outUrl.searchParams.set(\"f\", \"xml\");\r\n        }\r\n    }\r\n    console.groupEnd();\r\n    return outUrl;\r\n}\r\nvar MetadataOptions = /** @class */ (function () {\r\n    /**\r\n     * Creates a new instance\r\n     * @param options options\r\n     */\r\n    function MetadataOptions(_a) {\r\n        var format = _a.format, output = _a.output, formatterPageUrl = _a.formatterPageUrl, whatToFormat = _a.whatToFormat;\r\n        this.format = format || \"fgdc\";\r\n        this.output = output || \"html\";\r\n        this.formatterPageUrl = formatterPageUrl || exports.defaultFormatterPage;\r\n        this.whatToFormat = whatToFormat || MetadataSourceEnum.Soe;\r\n    }\r\n    MetadataOptions.prototype.wrapMetadataUrl = function (url) {\r\n        return wrapUrlWithFormatterPage(url, this);\r\n    };\r\n    return MetadataOptions;\r\n}());\r\nexports.MetadataOptions = MetadataOptions;\r\n/**\r\n * Adds a \"load\" event handler to a layer list. When the layer list has loaded,\r\n * A metadata tab will be added to each layers list item after its checkbox is\r\n * clicked for the first time.\r\n *\r\n * **Must be called before LayerList.startup()!**\r\n * @param layerList Layer List dijit\r\n * @param formatterPageUrl URL of formatter page.\r\n */\r\nfunction addMetadataTabs(layerList, options) {\r\n    if (options === void 0) { options = {\r\n        format: \"fgdc\",\r\n        output: \"html\",\r\n        formatterPageUrl: exports.defaultFormatterPage,\r\n        whatToFormat: MetadataSourceEnum.Soe\r\n    }; }\r\n    layerList.on(\"load\", function (_a) {\r\n        var target = _a.target;\r\n        // Get the DOM node of the layer list\r\n        var node = target;\r\n        // Get the checkboxes for each layer.\r\n        var checkboxes = node.querySelectorAll(\".esriTitleContainer > input[type=checkbox]:not([data-sublayer-index])\");\r\n        function setupMetadataTab(checkbox) {\r\n            if (!checkbox.dataset.layerIndex) {\r\n                return;\r\n            }\r\n            var layerIndex = parseInt(checkbox.dataset.layerIndex, 10);\r\n            var opLayer = layerList.layers[layerIndex];\r\n            var tabContainer;\r\n            try {\r\n                tabContainer = getTabContainerFromCheckbox(checkbox);\r\n            }\r\n            catch (err) {\r\n                // If its one of the sublayer checkboxes, a TypeError\r\n                // with be thrown.\r\n                if (!(err instanceof TypeError)) {\r\n                    throw err;\r\n                }\r\n            }\r\n            if (tabContainer) {\r\n                addMetadataTab(tabContainer, opLayer, layerIndex, options);\r\n            }\r\n        }\r\n        // Setup an event to occur the first time layer's checkbox is clicked.\r\n        Array.from(checkboxes, function (cb) {\r\n            if (cb.checked) {\r\n                setupMetadataTab(cb);\r\n            }\r\n            else {\r\n                cb.addEventListener(\"click\", function (ev) {\r\n                    // \"this\" is the checkbox that was clicked.\r\n                    setupMetadataTab(this);\r\n                }, {\r\n                    once: true,\r\n                    passive: true\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.addMetadataTabs = addMetadataTabs;\r\n/**\r\n * Gets the tab container for the layer corresponding to the given checkbox\r\n * @param checkbox A checkbox input element.\r\n */\r\nfunction getTabContainerFromCheckbox(checkbox) {\r\n    var tabContainer = checkbox.parentElement.parentElement\r\n        .nextElementSibling;\r\n    return tabContainer;\r\n}\r\n/**\r\n * Parses a metadata source name into its component parts: database, schema, and table,\r\n * returning a document fragment with a corresponding span element for each.\r\n * @param dataSourceName The name of a metadata source.\r\n * @returns Returns a DocumentFragment containing span elements corresponding to database,\r\n * schema, and table parts of the metadata source name. If name can't be parsed, a\r\n * Text node with the input string is instead returned.\r\n */\r\nfunction createFCNameSpans(dataSourceName) {\r\n    var nameRe = /^([^\\.]+)\\.([^\\.]+)\\.([^\\.]+)$/i;\r\n    var match = dataSourceName.match(nameRe);\r\n    if (match) {\r\n        // Get the parts of the table name.\r\n        var _a = tslib_1.__read(match, 4), db = _a[1], schema = _a[2], table = _a[3];\r\n        var dbSpan = document.createElement(\"span\");\r\n        var schemaSpan = document.createElement(\"span\");\r\n        var tableSpan = document.createElement(\"span\");\r\n        dbSpan.textContent = db;\r\n        schemaSpan.textContent = schema;\r\n        tableSpan.textContent = table;\r\n        dbSpan.classList.add(\"metadata-source-name__db\");\r\n        schemaSpan.classList.add(\"metadata-source-name__schema\");\r\n        tableSpan.classList.add(\"metadata-source-name__table\");\r\n        var docFrag_1 = document.createDocumentFragment();\r\n        [dbSpan, schemaSpan, tableSpan].forEach(function (s) {\r\n            docFrag_1.appendChild(s);\r\n        });\r\n        return docFrag_1;\r\n    }\r\n    return document.createTextNode(dataSourceName);\r\n}\r\n/**\r\n * Detects if the current layer supports metadata.\r\n * @param layer an operational layer\r\n * @param metadataOptions Specify the metadata output format.\r\n * @returns Returns an object which has properties named after layer names and these properties' values are the metadata URLs.\r\n */\r\nfunction getBuiltInMetadataUrls(layer, metadataOptions) {\r\n    var _a;\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        function appendParameters(url) {\r\n            if (format) {\r\n                url.searchParams.set(\"format\", format);\r\n            }\r\n            if (output) {\r\n                if (!format) {\r\n                    console.warn(\"Metadata \\\"output\\\" parameter has been set to \\\"\".concat(output, \"\\\", but no value was given for the corresponding \\\"format\\\" parameter.\"));\r\n                }\r\n                url.searchParams.set(\"output\", output);\r\n            }\r\n        }\r\n        var layerUrl, serviceRootRe, serviceRootMatch, format, output, metadataUrl, layersUrl, response, layerInfo, mdLinks, metadataUrls, metadataUrls_1, metadataUrls_1_1, _b, name_1, url;\r\n        var _c, e_1, _d;\r\n        return tslib_1.__generator(this, function (_e) {\r\n            switch (_e.label) {\r\n                case 0:\r\n                    layerUrl = (_a = layer.layer) === null || _a === void 0 ? void 0 : _a.url;\r\n                    if (!layerUrl) {\r\n                        return [2 /*return*/, null];\r\n                    }\r\n                    serviceRootRe = /(?:(?:Map)|(?:Feature))Server(\\/?)$/g;\r\n                    serviceRootMatch = layerUrl.match(serviceRootRe);\r\n                    format = metadataOptions.format, output = metadataOptions.output;\r\n                    if (!serviceRootMatch) {\r\n                        // Exit if not a supported URL type.\r\n                        return [2 /*return*/, null];\r\n                    }\r\n                    else if (!serviceRootMatch[1]) {\r\n                        // Append trailing slash to URL if not present.\r\n                        layerUrl += \"/\";\r\n                    }\r\n                    metadataUrl = new URL(\"\".concat(layerUrl, \"info/metadata\"));\r\n                    appendParameters(metadataUrl);\r\n                    layersUrl = new URL(\"\".concat(layerUrl, \"layers?f=json\"));\r\n                    return [4 /*yield*/, fetch(layersUrl)];\r\n                case 1:\r\n                    response = _e.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    layerInfo = _e.sent();\r\n                    mdLinks = (_c = {},\r\n                        _c[\"\".concat(layer.title || \"Service\")] = metadataUrl.href,\r\n                        _c);\r\n                    metadataUrls = layerInfo.layers.filter(function (l) { return l.hasMetadata; }).map(function (l) {\r\n                        var url = new URL(\"\".concat(layerUrl).concat(l.id, \"/metadata/\"));\r\n                        appendParameters(url);\r\n                        return [l.name, url.href];\r\n                    });\r\n                    try {\r\n                        for (metadataUrls_1 = tslib_1.__values(metadataUrls), metadataUrls_1_1 = metadataUrls_1.next(); !metadataUrls_1_1.done; metadataUrls_1_1 = metadataUrls_1.next()) {\r\n                            _b = tslib_1.__read(metadataUrls_1_1.value, 2), name_1 = _b[0], url = _b[1];\r\n                            mdLinks[name_1] = url;\r\n                        }\r\n                    }\r\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n                    finally {\r\n                        try {\r\n                            if (metadataUrls_1_1 && !metadataUrls_1_1.done && (_d = metadataUrls_1.return)) _d.call(metadataUrls_1);\r\n                        }\r\n                        finally { if (e_1) throw e_1.error; }\r\n                    }\r\n                    return [2 /*return*/, mdLinks];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Adds the metadata tab to a layer's tab container after checking to see\r\n * if the layer in question supports the LayerMetadata SOE.\r\n * @param tabContainer\r\n * @param operationalLayer\r\n * @param layerIndex\r\n * @param options\r\n */\r\nfunction addMetadataTab(tabContainer, operationalLayer, layerIndex, options) {\r\n    var _a;\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        function enumerateMetadataUrls(mdLinks) {\r\n            var _a, _b, _i, key, url;\r\n            return tslib_1.__generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        if (!mdLinks)\r\n                            return [2 /*return*/];\r\n                        _a = [];\r\n                        for (_b in mdLinks)\r\n                            _a.push(_b);\r\n                        _i = 0;\r\n                        _c.label = 1;\r\n                    case 1:\r\n                        if (!(_i < _a.length)) return [3 /*break*/, 4];\r\n                        key = _a[_i];\r\n                        if (!Object.prototype.hasOwnProperty.call(mdLinks, key)) return [3 /*break*/, 3];\r\n                        url = mdLinks[key];\r\n                        return [4 /*yield*/, [key, url]];\r\n                    case 2:\r\n                        _c.sent();\r\n                        _c.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3 /*break*/, 1];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        }\r\n        var format, mdLinks, mdLinkArray, url, soeMetadataSupported, tabId, listItem, tab, tabList, tabs, ul, name_2, mdUrl, a, li;\r\n        return tslib_1.__generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    // Exit early if there is no layer URL.\r\n                    if (!((_a = operationalLayer === null || operationalLayer === void 0 ? void 0 : operationalLayer.layer) === null || _a === void 0 ? void 0 : _a.url)) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    format = options.format;\r\n                    return [4 /*yield*/, getBuiltInMetadataUrls(operationalLayer, options)];\r\n                case 1:\r\n                    mdLinks = _b.sent();\r\n                    mdLinkArray = tslib_1.__spreadArray([], tslib_1.__read(enumerateMetadataUrls(mdLinks)), false);\r\n                    if (!(mdLinkArray.length <= 1)) return [3 /*break*/, 4];\r\n                    url = operationalLayer.layer.url;\r\n                    return [4 /*yield*/, (0, layer_metadata_soe_client_1.detectLayerMetadataSupport)(url)];\r\n                case 2:\r\n                    soeMetadataSupported = _b.sent();\r\n                    if (!soeMetadataSupported) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    return [4 /*yield*/, (0, layer_metadata_soe_client_1.getMetadataLinks)(url)];\r\n                case 3:\r\n                    // Get metadata URLs.\r\n                    mdLinks = _b.sent();\r\n                    _b.label = 4;\r\n                case 4:\r\n                    tabId = \"metadata\";\r\n                    listItem = document.createElement(\"li\");\r\n                    listItem.tabIndex = 0;\r\n                    listItem.dataset.tabId = tabId;\r\n                    listItem.dataset.layerIndex = layerIndex.toString(10);\r\n                    listItem.setAttribute(\"role\", \"tab\");\r\n                    listItem.classList.add(\"esriTabMenuItem\");\r\n                    listItem.textContent = \"Metadata\";\r\n                    tab = document.createElement(\"div\");\r\n                    tab.classList.add(\"esriTab\", \"metadata-panel\");\r\n                    tab.setAttribute(\"role\", \"tabpanel\");\r\n                    tab.dataset.tabId = tabId;\r\n                    tabList = tabContainer.firstElementChild;\r\n                    tabs = tabContainer.children[1];\r\n                    tabList.appendChild(listItem);\r\n                    tabs.appendChild(tab);\r\n                    ul = document.createElement(\"ul\");\r\n                    ul.classList.add(\"layer-metadata-list\");\r\n                    for (name_2 in mdLinks) {\r\n                        if (mdLinks.hasOwnProperty(name_2)) {\r\n                            mdUrl = mdLinks[name_2];\r\n                            a = document.createElement(\"a\");\r\n                            a.target = \"wsdot-metadata\";\r\n                            a.href = wrapUrlWithFormatterPage(mdUrl, options).href;\r\n                            a.appendChild(createFCNameSpans(name_2));\r\n                            li = document.createElement(\"li\");\r\n                            li.appendChild(a);\r\n                            ul.appendChild(li);\r\n                        }\r\n                    }\r\n                    tab.appendChild(ul);\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.makeBooleanRe = exports.makeReGroup = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar trueStrings = [\"true\", \"on\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\nvar falseStrings = [\"false\", \"off\", \"\", \"X\"];\r\n/**\r\n * Creates a regular expression that will match if tested against a string\r\n * containing any of the strings in the input array.\r\n * @param strings An array of strings\r\n * @param exclusive Set to true to start regex with \"^\" and end with \"$\", false (or omit) otherwise.\r\n * @example\r\n * const trueStrings = [\"true\", \"on\", \"1\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\n * const falseStrings = [\"false\", \"off\", \"0\", \"\", \"X\"];\r\n * const trueRe = makeReGroup(trueStrings);\r\n * // /(?:true)|(?:on)|(?:1)|(?:)|(?:)|(?:)|(?:)|(?:)|(?:)/\r\n * const falseRe = makeReGroup(falseStrings);\r\n * // /(?:false)|(?:off)|(?:0)|(?:)|(?:X)/\r\n */\r\nfunction makeReGroup(strings, exclusive) {\r\n    var pattern = strings.map(function (s) { return \"(?:\".concat(s, \")\"); }).join(\"|\");\r\n    if (exclusive) {\r\n        pattern = \"^(?:\".concat(pattern, \")$\");\r\n    }\r\n    return new RegExp(\"\".concat(pattern), \"i\");\r\n}\r\nexports.makeReGroup = makeReGroup;\r\n/**\r\n * Creates a RegExp that will match boolean values.\r\n * @param matchOnly Set to true to only match true value strings.\r\n * Set to false to only match false value strings.\r\n * Set to non-boolean (e.g., undefined or null) to match either true or false.\r\n * @param exclusive\r\n */\r\nfunction makeBooleanRe(matchOnly, exclusive) {\r\n    var parts = matchOnly === true\r\n        ? trueStrings\r\n        : matchOnly === false\r\n            ? falseStrings\r\n            : trueStrings.concat.apply(trueStrings, tslib_1.__spreadArray([], tslib_1.__read(falseStrings), false));\r\n    return makeReGroup(parts, exclusive);\r\n}\r\nexports.makeBooleanRe = makeBooleanRe;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.createLayerLink = exports.setOperationalLayers = void 0;\r\nvar tslib_1 = require(\"tslib\");\r\nvar webMercatorUtils_1 = tslib_1.__importDefault(require(\"esri/geometry/webMercatorUtils\"));\r\nvar LayerSettings_1 = require(\"./LayerSettings\");\r\n/**\r\n * Updates the layers' settings to match those from URL search parameters.\r\n * This function should be run on the operational layers **before** they are added\r\n * to a LayerList.\r\n * @param search URL search string\r\n * @param opLayers Operational layers\r\n */\r\nfunction setOperationalLayers(search, opLayers) {\r\n    var e_1, _a;\r\n    if (!search || !window.URLSearchParams) {\r\n        return;\r\n    }\r\n    try {\r\n        for (var opLayers_1 = tslib_1.__values(opLayers), opLayers_1_1 = opLayers_1.next(); !opLayers_1_1.done; opLayers_1_1 = opLayers_1.next()) {\r\n            var opLayer = opLayers_1_1.value;\r\n            // Skip if layer has no corresponding entry in URLSearchParams.\r\n            if (!opLayer.id || !search.has(opLayer.id)) {\r\n                continue;\r\n            }\r\n            var val = search.get(opLayer.id);\r\n            if (!val) {\r\n                // Skip if there is no value. (E.g., value is empty string.)\r\n                continue;\r\n            }\r\n            // parse string value into layer settings object.\r\n            var layerSettings = LayerSettings_1.LayerSettings.parse(val);\r\n            if (!layerSettings) {\r\n                // tslint:disable-next-line:no-console\r\n                console.warn(\"could not parse \\\"\".concat(val, \"\\\" into layer settings for layer \").concat(opLayer.id, \".\"));\r\n                continue;\r\n            }\r\n            layerSettings.apply(opLayer);\r\n        }\r\n    }\r\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n    finally {\r\n        try {\r\n            if (opLayers_1_1 && !opLayers_1_1.done && (_a = opLayers_1.return)) _a.call(opLayers_1);\r\n        }\r\n        finally { if (e_1) throw e_1.error; }\r\n    }\r\n}\r\nexports.setOperationalLayers = setOperationalLayers;\r\n/**\r\n * Creates a link on the map that will, when clicked, copy the URL of the page with\r\n * URL search parameters.\r\n *\r\n * CSS classes of output elements:\r\n *\r\n *  class name           | description\r\n *  ------------------   | -----------\r\n * .layer-link           | this class will be applied to the div element that contains the link.\r\n * .layer-link--copied   | This class will be added to the div after the user has clicked the link and successfully updated the browsers URL via History API. Removed after user changes the state of the map and the URL is updated.\r\n * .layer-link--disabled | This class is applied initially to the div and is removed once the user has changed the map in a way that updates the link's URL.\r\n * .layer-link__anchor   | this class is applied to the anchor element.\r\n *\r\n * @param layerList A layer list control\r\n * @returns An object that contains the \"root\" HTML element control and the event handlers used to update the URL to match the map's state.\r\n */\r\nfunction createLayerLink(layerList) {\r\n    var urlSupported = window.URL && window.URLSearchParams && window.history;\r\n    if (!urlSupported) {\r\n        throw new Error(\"Browser must support all of the following features: URL, URLSearchParams, history.\");\r\n    }\r\n    var div = document.createElement(\"div\");\r\n    div.classList.add(\"layer-link\");\r\n    var a = document.createElement(\"a\");\r\n    a.href = new URL(location.href, location.href.replace(/\\?.+$/, \"\")).toString();\r\n    a.textContent = \"\";\r\n    a.title = \"Click to update URL with layer and extent paramters.\";\r\n    a.target = \"_blank\";\r\n    a.classList.add(\"layer-link__anchor\");\r\n    var copiedClass = \"layer-link--copied\";\r\n    var disabledClass = \"layer-link--disabled\";\r\n    div.classList.add(disabledClass);\r\n    div.appendChild(a);\r\n    // Setup event to update the \"map-extent\" URL search parameter when the map's extent is changed.\r\n    var extentChangeHandle = layerList.map.on(\"extent-change\", function (_a) {\r\n        var extent = _a.extent;\r\n        extent = webMercatorUtils_1.default.webMercatorToGeographic(extent);\r\n        // Get the coordinates of the new extent.\r\n        var xmin = extent.xmin, ymin = extent.ymin, xmax = extent.xmax, ymax = extent.ymax;\r\n        // round to 4 dec. places and concatenate into space-separated string.\r\n        var searchValue = [xmin, ymin, xmax, ymax]\r\n            .map(function (n) {\r\n            return Math.round(n * 10000) / 10000;\r\n        })\r\n            .join(\" \");\r\n        // Add or update the \"map-extent\" property with the coordinates string,\r\n        // then set the anchor's href to this new URL.\r\n        var url = new URL(a.href);\r\n        url.searchParams.set(\"map-extent\", searchValue);\r\n        a.href = url.toString();\r\n        // remove the disabled and copied classes to indicate to the user that the link href has been updated\r\n        // since they last copied.\r\n        div.classList.remove(disabledClass);\r\n        div.classList.remove(copiedClass);\r\n    });\r\n    // Setup event handler to update URL when map layers are toggled on or off.\r\n    var layerToggleHandle = layerList.on(\"toggle\", function (toggleEvent) {\r\n        console.group(\"LayerList toggle event\");\r\n        // Enable and turn off copied status.\r\n        div.classList.remove(copiedClass);\r\n        div.classList.remove(disabledClass);\r\n        var layerIndex = toggleEvent.layerIndex, visible = toggleEvent.visible, subLayerIndex = toggleEvent.subLayerIndex;\r\n        console.debug(\"layer: \".concat(layerIndex, \", sublayer \").concat(subLayerIndex, \", visible: \").concat(visible));\r\n        // Get the operational layer from the layer list based on the event's layerIndex.\r\n        var operationalLayer = layerList.layers[layerIndex];\r\n        // Get the URL currently in the link's href attribute.\r\n        // Store in URL object so that search params can be\r\n        // easily searched and manipulated.\r\n        var url = new URL(a.href);\r\n        // Retrieve the current settings store in the URL for this layer.\r\n        // If there are no settings, the old settings variable will be null.\r\n        var oldSettingStr = url.searchParams.get(operationalLayer.id);\r\n        var oldSettings = oldSettingStr\r\n            ? LayerSettings_1.LayerSettings.parse(oldSettingStr)\r\n            : null;\r\n        // Detect if the settings for this layer had sublayers specified.\r\n        var hadSublayersDefined = oldSettings\r\n            ? !!oldSettings.visibleLayers\r\n            : false;\r\n        var layerSettings = new LayerSettings_1.LayerSettings({\r\n            visible: operationalLayer.visibility,\r\n            visibleLayers: operationalLayer.layer\r\n                .visibleLayers\r\n        });\r\n        // Initialize layer settings object.\r\n        // let layerSettings: LayerSettings;\r\n        // Layer settings string for the URL will simply indicate if\r\n        // the parent layer is on or off except under these conditions:\r\n        // * Ability to change sublayer visibility is enabled for current layer.\r\n        // * User changed visibility of sublayer via UI or sublayer visibility\r\n        //   had been previously set in the URL.\r\n        // if (\r\n        //   operationalLayer.showSubLayers &&\r\n        //   (hadSublayersDefined || subLayerIndex != null)\r\n        // ) {\r\n        //   layerSettings = new LayerSettings(operationalLayer.layer);\r\n        // } else {\r\n        //   layerSettings = new LayerSettings({ visible });\r\n        // }\r\n        // Update the URL search parameter for this layer and assign updated URL to link's href.\r\n        url.searchParams.set(operationalLayer.id, layerSettings.toString());\r\n        a.href = url.toString();\r\n    });\r\n    // Setup link click event. When link is clicked, URL will be updated.\r\n    a.onclick = function (e) {\r\n        if (window.history) {\r\n            history.replaceState(undefined, document.title, a.href);\r\n            div.classList.add(copiedClass);\r\n            return false;\r\n        }\r\n    };\r\n    var mapRoot = layerList.map.root;\r\n    mapRoot.appendChild(div);\r\n    return { layerToggleHandle: layerToggleHandle, extentChangeHandle: extentChangeHandle, root: div };\r\n}\r\nexports.createLayerLink = createLayerLink;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__598__;","module.exports = __WEBPACK_EXTERNAL_MODULE__48__;","module.exports = __WEBPACK_EXTERNAL_MODULE__957__;","module.exports = __WEBPACK_EXTERNAL_MODULE__940__;","module.exports = __WEBPACK_EXTERNAL_MODULE__655__;","module.exports = __WEBPACK_EXTERNAL_MODULE__436__;","module.exports = __WEBPACK_EXTERNAL_MODULE__672__;","module.exports = __WEBPACK_EXTERNAL_MODULE__117__;","module.exports = __WEBPACK_EXTERNAL_MODULE__889__;","module.exports = __WEBPACK_EXTERNAL_MODULE__231__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import GroupedLayerList, {\r\n  createLayerLink,\r\n  fromGeoportalLayers,\r\n  setOperationalLayers\r\n} from \"@wsdot/grouped-layer-list\";\r\nimport BorderContainer from \"dijit/layout/BorderContainer\";\r\nimport ContentPane from \"dijit/layout/ContentPane\";\r\nimport arcgisUtils from \"esri/arcgis/utils\";\r\nimport esriConfig from \"esri/config\";\r\nimport HomeButton from \"esri/dijit/HomeButton\";\r\nimport Extent from \"esri/geometry/Extent\";\r\nimport EsriMap from \"esri/map\";\r\nimport { FormatError } from \"../FormatError\";\r\nimport { createSourceLink } from \"../GithubLink\";\r\nimport configs, { getConfigLayers } from \"./config/main\";\r\nimport { createConfigSelector } from \"./configSelector\";\r\n\r\nconst urlSupported = window.URL && window.URLSearchParams && window.history;\r\n\r\nesriConfig.defaults.io.httpsDomains.push(\"wsdot.wa.gov\");\r\nesriConfig.defaults.io.corsEnabledServers.push(\r\n  \"wsdot.wa.gov\",\r\n  \"data.wsdot.wa.gov\"\r\n);\r\n\r\nconst borderContainer = new BorderContainer(\r\n  { liveSplitters: true },\r\n  \"container\"\r\n);\r\nconst layerListPane = new ContentPane(\r\n  { region: \"left\", style: \"width: 300px; padding: 0\", splitter: true },\r\n  \"layerListContainer\"\r\n);\r\nconst mapPane = new ContentPane(\r\n  { region: \"center\", style: \"padding: 0\" },\r\n  \"mapContainer\"\r\n);\r\nborderContainer.addChild(layerListPane);\r\nborderContainer.addChild(mapPane);\r\nborderContainer.startup();\r\n\r\n/**\r\n * Gets extent from URL if one is defined there.\r\n */\r\nfunction getExtentFromUrl() {\r\n  const url = new URL(location.href);\r\n  const extStr = url.searchParams.get(\"map-extent\");\r\n  if (!extStr) {\r\n    return undefined;\r\n  }\r\n\r\n  const [xmin, ymin, xmax, ymax] = extStr\r\n    .split(/[\\s,]/g)\r\n    .map(s => parseFloat(s));\r\n\r\n  const extent = new Extent({\r\n    xmin,\r\n    ymin,\r\n    xmax,\r\n    ymax,\r\n    spatialReference: { wkid: 4326 }\r\n  });\r\n  return extent;\r\n}\r\n\r\n/**\r\n * Extent of WA.\r\n * @see https://epsg.io/1416-area\r\n */\r\nconst waExtent = new Extent({\r\n  xmin: -124.79,\r\n  ymin: 45.54,\r\n  xmax: -116.91,\r\n  ymax: 49.05\r\n});\r\n\r\nconst searchParams = urlSupported ? new URLSearchParams(location.search) : null;\r\nconst configLayers = searchParams\r\n  ? searchParams.has(\"config\")\r\n    ? getConfigLayers(searchParams.get(\"config\")!).layers\r\n    : configs.config.layers\r\n  : configs.config.layers;\r\n\r\nconst { groups, layers } = fromGeoportalLayers(configLayers);\r\n\r\nconst map = new EsriMap(\"map\", {\r\n  basemap: \"dark-gray-vector\",\r\n  extent: getExtentFromUrl() || waExtent\r\n});\r\n\r\nconst mapButtonDiv = document.createElement(\"button\");\r\nmapButtonDiv.id = \"homeButton\";\r\nmap.root.appendChild(mapButtonDiv);\r\n\r\nconst homeButton = new HomeButton(\r\n  {\r\n    visible: true,\r\n    map\r\n  },\r\n  mapButtonDiv\r\n);\r\nhomeButton.startup();\r\n\r\n// Create the layer list.\r\n\r\nif (searchParams) {\r\n  setOperationalLayers(searchParams, layers);\r\n}\r\n\r\n// Add the operational layers' layers to the map.\r\nmap.addLayers(layers.map(opLayer => opLayer.layer!));\r\n\r\nconst layerList = new GroupedLayerList(\r\n  {\r\n    groups,\r\n    showLegend: true,\r\n    showOpacitySlider: true,\r\n    showSubLayers: true,\r\n    groupProperty: \"title\",\r\n    map,\r\n    metadata: true,\r\n    layers,\r\n    throwOnGroupNotFound: false\r\n  },\r\n  \"layerList\"\r\n);\r\n\r\nlayerList.startup();\r\n\r\nif (urlSupported) {\r\n  createLayerLink(layerList);\r\n}\r\n\r\ntry {\r\n  const sourceLink = createSourceLink(\r\n    \"https://www.github.com/wsdot-gis/grouped-layer-list\"\r\n  );\r\n  map.root.appendChild(sourceLink);\r\n} catch (err) {\r\n  if (!(err instanceof FormatError)) {\r\n    throw err;\r\n  }\r\n}\r\n\r\nconst configSelector = createConfigSelector();\r\nconfigSelector.id = \"configSelect\";\r\nmap.root.appendChild(configSelector);\r\n"],"names":["extendStatics","__extends","this","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","defineProperty","exports","validLayersUrl","layerSourcesUrl","metadataUrl","ArcGisError","_super","errorInfo","_this","message","code","Error","getServiceInfo","serviceUrl","serviceInfo","_a","fetch","join","json","error","getLayerSources","url","detectLayerMetadataSupport","supportedExtensions","test","getMetadataLinks","layerSources","requestUrl","output","key","getValidLayers","obj","layerIds","JSON","stringify","expectedFormat","FormatError","ghPagesToGithubUrl","location","href","re","match","owner","project","a","document","createElement","target","rel","span","textContent","classList","add","appendChild","docFrag","createDocumentFragment","option","configName","text","selected","disabled","title","pageTitle","select","name","form","action","addEventListener","submit","airport","config","crmp","fishPassageBarriers","functionalClass","traffic","String","__assign","assign","s","i","arguments","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__createBinding","o","m","k","k2","undefined","__esModule","writable","configurable","enumerable","get","__exportStar","__values","__read","ar","__spread","concat","__spreadArrays","il","j","jl","__spreadArray","to","from","pack","l","slice","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__setModuleDefault","__importStar","mod","__importDefault","default","__classPrivateFieldGet","receiver","state","kind","has","__classPrivateFieldSet","set","__classPrivateFieldIn","LayerSettings","reUtils_1","options","visible","visibleLayers","parse","str","trueRe","makeBooleanRe","falseRe","sublayersMatch","map","parseInt","operationalLayer","layer","refreshAbleLayer","suspend","visibility","setVisibility","showSubLayers","setVisibleLayers","toString","checkedState","fromGeoportalLayers","tslib_1","ArcGISDynamicMapServiceLayer_1","ArcGISTiledMapServiceLayer_1","configLayerToOpLayer","configLayer","layerType","id","replace","opacity","showLegend","showOpacitySlider","configLayers","layers","groups","isArray","groupName","opLayers","forEach","ol","convertLayer","getGroupsFromCreateMapItem","LayerList_1","metadataUtils_1","itemInfo","itemData","applicationProperties","viewing","layerGrouping","enabled","opLayer","layerObject","layerInfos","GroupedLayerList","srcNode","originLayers","sortedLayers_1","bind","titleGroups","propertyName","throwOnValueNotFound","_b","_i","titles","_loop_1","titles_1","titles_1_1","e_1_1","e_1","_c","_d","msg","_e","find","ReferenceError","console","warn","return","enumerateLayersInGroupOrder","groupProperty","throwOnGroupNotFound","filter","includes","reverse","nodeId","HTMLElement","_nodeId","on","evt","cssText","rootNode","getElementById","previousGroupName","listItems","querySelectorAll","mapping","Map","_loop_2","ln","createTitleToGroupMapping","groupNo","classToGroupNameMapping","li","querySelector","className","addGroupHeadings","styleNode","head","addMetadataTabs","metadataOptions","MetadataOptions","isSoeMetadataUrl","MetadataSourceEnum","defaultFormatterPage","layer_metadata_soe_client_1","URL","wrapUrlWithFormatterPage","outUrl","shouldWrap","formatterPageUrl","format","whatToFormat","isSoe","None","Soe","debug","BuiltIn","groupEnd","paramUrl","searchParams","delete","wrapMetadataUrl","createFCNameSpans","dataSourceName","db","schema","table","dbSpan","schemaSpan","tableSpan","docFrag_1","createTextNode","getBuiltInMetadataUrls","appendParameters","layerUrl","serviceRootRe","serviceRootMatch","layersUrl","layerInfo","mdLinks","metadataUrls","metadataUrls_1","metadataUrls_1_1","name_1","hasMetadata","layerList","checkboxes","setupMetadataTab","checkbox","dataset","layerIndex","tabContainer","parentElement","nextElementSibling","getTabContainerFromCheckbox","err","tabId","listItem","tab","tabList","tabs","ul","name_2","mdUrl","enumerateMetadataUrls","tabIndex","setAttribute","firstElementChild","children","addMetadataTab","cb","checked","ev","once","passive","makeReGroup","trueStrings","falseStrings","strings","exclusive","pattern","RegExp","matchOnly","createLayerLink","setOperationalLayers","webMercatorUtils_1","LayerSettings_1","search","window","URLSearchParams","opLayers_1","opLayers_1_1","val","layerSettings","history","div","copiedClass","disabledClass","extentChangeHandle","extent","searchValue","webMercatorToGeographic","xmin","ymin","xmax","ymax","Math","round","remove","layerToggleHandle","toggleEvent","group","subLayerIndex","oldSettingStr","oldSettings","onclick","replaceState","root","module","__WEBPACK_EXTERNAL_MODULE__598__","__WEBPACK_EXTERNAL_MODULE__48__","__WEBPACK_EXTERNAL_MODULE__957__","__WEBPACK_EXTERNAL_MODULE__940__","__WEBPACK_EXTERNAL_MODULE__655__","__WEBPACK_EXTERNAL_MODULE__436__","__WEBPACK_EXTERNAL_MODULE__672__","__WEBPACK_EXTERNAL_MODULE__117__","__WEBPACK_EXTERNAL_MODULE__889__","__WEBPACK_EXTERNAL_MODULE__231__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","prop","toStringTag","urlSupported","defaults","io","httpsDomains","corsEnabledServers","borderContainer","liveSplitters","layerListPane","region","style","splitter","mapPane","addChild","startup","waExtent","getConfigLayers","basemap","extStr","split","parseFloat","spatialReference","wkid","getExtentFromUrl","mapButtonDiv","addLayers","sourceLink","createSourceLink","configSelector","createConfigSelector"],"sourceRoot":""}