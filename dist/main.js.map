{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../grouped-layer-list/dist/main.js","webpack:///external \"esri/config\"","webpack:///../grouped-layer-list/node_modules/tslib/tslib.es6.js","webpack:///external \"esri/arcgis/utils\"","webpack:///external \"esri/dijit/HomeButton\"","webpack:///external \"esri/geometry/Extent\"","webpack:///external \"esri/geometry/webMercatorUtils\"","webpack:///external \"esri/arcgis/Portal\"","webpack:///external \"esri/dijit/LayerList\"","webpack:///../grouped-layer-list/dist/metadataUtils.js","webpack:///../grouped-layer-list/node_modules/@wsdot/layer-metadata-soe-client/index.js","webpack:///./src/reUtils.ts","webpack:///./src/LayerSettings.ts","webpack:///./src/WebmapSelector.ts","webpack:///./src/main.ts","webpack:///./src/searchUtils.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","tslib_1","LayerList_1","__importDefault","metadataUtils_1","addGroupHeadings","srcNode","groups","previousGroupName","listItems","document","getElementById","querySelectorAll","mapping","Map","_loop_2","groupName","forEach","ln","set","createTitleToGroupMapping","groupNo","classToGroupNameMapping","li","label","querySelector","title","textContent","className","classList","add","Array","from","_a","_b","__read","join","getGroupsFromCreateMapItem","itemInfo","itemData","applicationProperties","viewing","layerGrouping","enabled","convertLayer","opLayer","id","visibility","layer","layerObject","showLegend","showOpacitySlider","showSubLayers","layerInfos","length","GroupedLayerList","_super","options","_this","this","originLayers","layers","sortedLayers_1","apply","__spread","titleGroups","propertyName","throwOnValueNotFound","e_1","_c","_i","titles","_loop_1","titles_1","titles_1_1","e_1_1","__generator","_d","push","msg","find","ReferenceError","console","warn","sent","trys","__values","next","done","error","return","enumerateLayersInGroupOrder","groupProperty","throwOnGroupNotFound","filter","includes","reverse","on","evt","cssText","styleNode","createElement","head","appendChild","metadata","addMetadataTabs","metadataFormatterPage","undefined","__extends","default","__WEBPACK_EXTERNAL_MODULE__1__","__webpack_exports__","__assign","__rest","__decorate","__param","__metadata","__awaiter","__exportStar","__await","__asyncGenerator","__asyncDelegator","__asyncValues","__makeTemplateObject","__importStar","extendStatics","b","setPrototypeOf","__proto__","__","constructor","assign","arguments","e","indexOf","getOwnPropertySymbols","decorators","target","desc","getOwnPropertyDescriptor","Reflect","decorate","paramIndex","decorator","metadataKey","metadataValue","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","rejected","result","then","body","f","y","g","_","ops","verb","throw","iterator","v","op","TypeError","pop","ar","concat","asyncIterator","q","a","resume","fulfill","settle","shift","cooked","raw","mod","k","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__4__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__8__","layer_metadata_soe_client_1","defaultFormatterPage","wrapUrlWithFormatterPage","metadataUrl","formatterPageUrl","encodeURIComponent","layerList","cb","addEventListener","ev","dataset","layerIndex","tabContainer","parseInt","parentElement","nextElementSibling","err","operationalLayer","url","mdLinks","listItem","tab","tabList","tabs","ul","name_1","mdUrl","detectLayerMetadataSupport","getMetadataLinks","tabIndex","tabId","toString","setAttribute","firstElementChild","children","href","addMetadataTab","once","passive","validLayersUrl","layerSourcesUrl","ArcGisError","errorInfo","message","code","Error","getServiceInfo","serviceUrl","serviceInfo","fetch","json","getLayerSources","supportedExtensions","test","layerSources","requestUrl","output","getValidLayers","obj","layerIds","JSON","stringify","trueStrings","falseStrings","makeBooleanRe","matchOnly","exclusive","strings","pattern","map","RegExp","makeReGroup","LayerSettings_LayerSettings","[object Object]","str","trueRe","falseRe","visibleLayers","visible","split","refreshAbleLayer","suspend","setVisibility","setVisibleLayers","wsdotAgolOrgId","config_default","defaults","io","httpsDomains","corsEnabledServers","mapInput","queryPomise","portal","Portal_default","Portal","queryResults","queryItems","num","results","getWebMaps","form","action","input","type","required","placeholder","source","datalist","button","pi","option","customEvent","CustomEvent","detail","dispatchEvent","createWebmapIdForm","mapId","match","location","search","getMapIDFromUrl","utils_default","createMap","mapOptions","extent","extStr","URL","searchParams","xmin","ymin","xmax","ymax","parseFloat","Extent_default","spatialReference","wkid","getExtentFromUrl","errors","mapButtonDiv","root","HomeButton_default","startup","groupings","main","group","groupEnd","operationalLayers","main_default","window","URLSearchParams","history","div","replace","webMercatorUtils_default","webMercatorToGeographic","searchValue","Math","round","remove","toggleEvent","subLayerIndex","oldSettingStr","oldSettings","parse","hadSublayersDefined","layerSettings","onclick","unsupportedMessage","clipboard","navigator","writeText","clipErr","alert","createLayerLink","opLayers","has","val","setOperationalLayers","catch"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","\"use strict\";\r\n/**\r\n * Exposes GroupLayerList class and related functions.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar LayerList_1 = tslib_1.__importDefault(require(\"esri/dijit/LayerList\"));\r\nvar metadataUtils_1 = require(\"./metadataUtils\");\r\n/**\r\n * Gets layer group definition (if present) from a web map.\r\n * @param itemInfo\r\n */\r\nfunction getGroupsFromCreateMapItem(itemInfo) {\r\n    if (itemInfo.itemData.applicationProperties) {\r\n        var applicationProperties = itemInfo.itemData.applicationProperties;\r\n        if (applicationProperties.viewing) {\r\n            var viewing = applicationProperties.viewing;\r\n            if (viewing.layerGrouping) {\r\n                var layerGrouping = viewing.layerGrouping;\r\n                if (layerGrouping && layerGrouping.enabled && layerGrouping.groups) {\r\n                    return layerGrouping.groups;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexports.getGroupsFromCreateMapItem = getGroupsFromCreateMapItem;\r\n/**\r\n * Converts the operational layer format returned from arcgis/utils.createMap to the\r\n * operation layer format expected by the LayerList constructor.\r\n * @param opLayer Operational layer object from arcgis/utils.createMap complete event.\r\n * @returns Operational layer for use with the LayerList constructor.\r\n */\r\nfunction convertLayer(opLayer) {\r\n    var id = opLayer.id, title = opLayer.title, visibility = opLayer.visibility;\r\n    var showLegend = true;\r\n    var showOpacitySlider = true;\r\n    var layer = opLayer.layerObject;\r\n    // Don't show sublayers tab if there is only one sublayer. Otherwise, show it.\r\n    var showSubLayers = layer.layerInfos\r\n        ? layer.layerInfos.length > 1\r\n        : true;\r\n    return {\r\n        id: id,\r\n        title: title,\r\n        layer: layer,\r\n        visibility: visibility,\r\n        showLegend: showLegend,\r\n        showOpacitySlider: showOpacitySlider,\r\n        showSubLayers: showSubLayers\r\n    };\r\n}\r\nexports.convertLayer = convertLayer;\r\n/**\r\n * Enumerate through the layers in the order presented in the grouping object.\r\n * @param titleGroups Grouping of layers\r\n * @param layers Array of layers\r\n * @param propertyName The name of the property. (Defaults to \"id\")\r\n * @param throwOnValueNotFound Set to true to throw a ReferenceError if a\r\n * group has a value that has no matching layer. If set to false, the invalid\r\n * value will simply be ignored.\r\n * @throws ReferenceError thrown if titleGroups contains a value that has no\r\n * corresponding layer when throwOnValueNotFound is true.\r\n * @yields {LayerListOperationalLayer}\r\n */\r\nfunction enumerateLayersInGroupOrder(titleGroups, layers, propertyName, throwOnValueNotFound) {\r\n    var e_1, _a, _b, _c, _i, groupName, titles, _loop_1, titles_1, titles_1_1, title, e_1_1;\r\n    if (propertyName === void 0) { propertyName = \"id\"; }\r\n    return tslib_1.__generator(this, function (_d) {\r\n        switch (_d.label) {\r\n            case 0:\r\n                _b = [];\r\n                for (_c in titleGroups)\r\n                    _b.push(_c);\r\n                _i = 0;\r\n                _d.label = 1;\r\n            case 1:\r\n                if (!(_i < _b.length)) return [3 /*break*/, 10];\r\n                groupName = _b[_i];\r\n                if (!titleGroups.hasOwnProperty(groupName)) return [3 /*break*/, 9];\r\n                titles = titleGroups[groupName];\r\n                _loop_1 = function (title) {\r\n                    var layer, msg;\r\n                    return tslib_1.__generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                layer = layers.find(function (l) { return l[propertyName] === title; });\r\n                                if (!layer) {\r\n                                    msg = \"No layer found with \\\"\" + propertyName + \"\\\" of \\\"\" + title + \"\\\".\";\r\n                                    if (throwOnValueNotFound) {\r\n                                        throw new ReferenceError(msg);\r\n                                    }\r\n                                    else {\r\n                                        console.warn(msg);\r\n                                        return [2 /*return*/, \"continue\"];\r\n                                    }\r\n                                }\r\n                                return [4 /*yield*/, layer];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [2 /*return*/];\r\n                        }\r\n                    });\r\n                };\r\n                _d.label = 2;\r\n            case 2:\r\n                _d.trys.push([2, 7, 8, 9]);\r\n                titles_1 = tslib_1.__values(titles), titles_1_1 = titles_1.next();\r\n                _d.label = 3;\r\n            case 3:\r\n                if (!!titles_1_1.done) return [3 /*break*/, 6];\r\n                title = titles_1_1.value;\r\n                return [5 /*yield**/, _loop_1(title)];\r\n            case 4:\r\n                _d.sent();\r\n                _d.label = 5;\r\n            case 5:\r\n                titles_1_1 = titles_1.next();\r\n                return [3 /*break*/, 3];\r\n            case 6: return [3 /*break*/, 9];\r\n            case 7:\r\n                e_1_1 = _d.sent();\r\n                e_1 = { error: e_1_1 };\r\n                return [3 /*break*/, 9];\r\n            case 8:\r\n                try {\r\n                    if (titles_1_1 && !titles_1_1.done && (_a = titles_1.return)) _a.call(titles_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n                return [7 /*endfinally*/];\r\n            case 9:\r\n                _i++;\r\n                return [3 /*break*/, 1];\r\n            case 10: return [2 /*return*/];\r\n        }\r\n    });\r\n}\r\n/**\r\n * Creates a mapping of layer titles to group names.\r\n * @param groups group definition object.\r\n */\r\nfunction createTitleToGroupMapping(groups) {\r\n    var mapping = new Map();\r\n    var _loop_2 = function (groupName) {\r\n        if (groups.hasOwnProperty(groupName)) {\r\n            var layerNames = groups[groupName];\r\n            layerNames.forEach(function (ln) { return mapping.set(ln, groupName); });\r\n        }\r\n    };\r\n    for (var groupName in groups) {\r\n        _loop_2(groupName);\r\n    }\r\n    return mapping;\r\n}\r\n/**\r\n * Adds group headings above the list item corresponding to the first layer\r\n * in a group.\r\n * @param srcNode the srcNode of a LayerList\r\n * @param groups Defines which layers are in which group.\r\n * @returns CSS text to be added to a style element to be added to the page head.\r\n */\r\nfunction addGroupHeadings(srcNode, groups) {\r\n    // srcNode can be defined as either a node's \"id\" or the node itself.\r\n    // Get the HTMLElement.\r\n    var rootNode = typeof srcNode === \"string\"\r\n        ? document.getElementById(srcNode)\r\n        : srcNode;\r\n    // Get all of the <li> elements that correspond to map layers.\r\n    var listItems = rootNode.querySelectorAll(\".esriList > li\");\r\n    // Create layer title-to-group mapping.\r\n    var mapping = createTitleToGroupMapping(groups);\r\n    // Initialize variable to hold previous group name from previous loop iteration.\r\n    var previousGroupName;\r\n    // Define a common css class for all list items that begin a group.\r\n    var groupStartClass = \"layer-list-group-start\";\r\n    // Initialize group counter\r\n    var groupNo = 0;\r\n    // Initialize CSS class name to group name mapping.\r\n    var classToGroupNameMapping = new Map();\r\n    // Assign CSS classes to the <li>s corresponding to the first layer in a group.\r\n    // For each such item, add item to the class-to-group mapping.\r\n    listItems.forEach(function (li) {\r\n        var label = li.querySelector(\"label\");\r\n        if (label) {\r\n            var title = label.textContent;\r\n            var groupName = mapping.get(title) || \"Other\";\r\n            if (groupName !== previousGroupName) {\r\n                var className = \"layer-list-group-\" + groupNo;\r\n                classToGroupNameMapping.set(className, groupName);\r\n                li.classList.add(groupStartClass, className);\r\n                groupNo++;\r\n            }\r\n            previousGroupName = groupName;\r\n        }\r\n    });\r\n    // Create the CSS definition.\r\n    var cssText = Array.from(classToGroupNameMapping, function (_a) {\r\n        var _b = tslib_1.__read(_a, 2), className = _b[0], groupName = _b[1];\r\n        return \".\" + className + \":before { content: '\" + groupName + \"' }\";\r\n    });\r\n    return cssText.join(\"\\n\");\r\n}\r\n/**\r\n * An extension of esri/dijit/LayerList that supports grouping.\r\n */\r\nvar GroupedLayerList = /** @class */ (function (_super) {\r\n    tslib_1.__extends(GroupedLayerList, _super);\r\n    function GroupedLayerList(options, srcNode) {\r\n        var _this = this;\r\n        // If options.groups is defined, sort the layers to match group definition\r\n        if (options.groups) {\r\n            var originLayers = options.layers;\r\n            var sortedLayers_1 = new (Array.bind.apply(Array, tslib_1.__spread([void 0], enumerateLayersInGroupOrder(options.groups, options.layers, options.groupProperty, options.throwOnGroupNotFound))))();\r\n            // Append any layers that are not listed in the grouping object.\r\n            originLayers\r\n                .filter(function (l) { return !sortedLayers_1.includes(l); })\r\n                .forEach(function (l) { return sortedLayers_1.push(l); });\r\n            // Change the layers' order to match the group object.\r\n            options.layers = sortedLayers_1.reverse();\r\n        }\r\n        _this = _super.call(this, options, srcNode) || this;\r\n        if (options.groups) {\r\n            _this.on(\"load\", function (evt) {\r\n                // Add group headers to the first layer's <li> using CSS :before pseudo-element.\r\n                var cssText = addGroupHeadings(srcNode, options.groups);\r\n                var styleNode = document.createElement(\"style\");\r\n                styleNode.textContent = cssText;\r\n                document.head.appendChild(styleNode);\r\n            });\r\n        }\r\n        if (options.metadata) {\r\n            metadataUtils_1.addMetadataTabs(_this, options.metadataFormatterPage || undefined);\r\n        }\r\n        return _this;\r\n    }\r\n    return GroupedLayerList;\r\n}(LayerList_1.default));\r\nexports.default = GroupedLayerList;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar layer_metadata_soe_client_1 = require(\"@wsdot/layer-metadata-soe-client\");\r\nvar defaultFormatterPage = \"https://wsdot-gis.github.io/geospatial-metadata\";\r\n/**\r\n * Creates a URL for a page that formats a metadata URL's XML into HTML.\r\n * @param metadataUrl Metadata URL.\r\n * @param formatterPageUrl Formatter page URL.\r\n */\r\nfunction wrapUrlWithFormatterPage(metadataUrl, formatterPageUrl) {\r\n    if (formatterPageUrl === void 0) { formatterPageUrl = defaultFormatterPage; }\r\n    if (!formatterPageUrl) {\r\n        return metadataUrl;\r\n    }\r\n    var xmlUrl = metadataUrl + \"?f=xml\";\r\n    var formatterSearch = \"url=\" + encodeURIComponent(xmlUrl);\r\n    var outUrl = formatterPageUrl + \"?\" + formatterSearch;\r\n    return outUrl;\r\n}\r\n/**\r\n * Adds a \"load\" event handler to a layer list. When the layer list has loaded,\r\n * A metadata tab will be added to each layers list item after its checkbox is\r\n * clicked for the first time.\r\n *\r\n * **Must be called before LayerList.startup()!**\r\n * @param layerList Layer List dijit\r\n * @param formatterPageUrl URL of formatter page.\r\n */\r\nfunction addMetadataTabs(layerList, formatterPageUrl) {\r\n    if (formatterPageUrl === void 0) { formatterPageUrl = defaultFormatterPage; }\r\n    layerList.on(\"load\", function (_a) {\r\n        var target = _a.target;\r\n        // Get the DOM node of the layer list\r\n        var node = target;\r\n        // Get the checkboxes for each layer.\r\n        var checkboxes = node.querySelectorAll(\".esriTitleContainer > input[type=checkbox]\");\r\n        // Setup an event to occur the first time layer's checkbox is clicked.\r\n        checkboxes.forEach(function (cb) {\r\n            cb.addEventListener(\"click\", function (ev) {\r\n                // \"this\" is the checkbox that was clicked.\r\n                if (!this.dataset.layerIndex) {\r\n                    return;\r\n                }\r\n                var layerIndex = parseInt(this.dataset.layerIndex, 10);\r\n                var opLayer = layerList.layers[layerIndex];\r\n                var tabContainer;\r\n                try {\r\n                    tabContainer = getTabContainerFromCheckbox(this);\r\n                }\r\n                catch (err) {\r\n                    // If its one of the sublayer checkboxes, a TypeError\r\n                    // with be thrown.\r\n                    // TODO: modify the querySelectorAll statement to be\r\n                    // more specific so that only the parent level checkboxes\r\n                    // are returned.\r\n                    if (!(err instanceof TypeError)) {\r\n                        throw err;\r\n                    }\r\n                }\r\n                if (tabContainer) {\r\n                    addMetadataTab(tabContainer, opLayer, layerIndex, formatterPageUrl);\r\n                }\r\n            }, {\r\n                once: true,\r\n                passive: true\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.addMetadataTabs = addMetadataTabs;\r\n/**\r\n * Gets the tab container for the layer corresponding to the given checkbox\r\n * @param checkbox A checkbox input element.\r\n */\r\nfunction getTabContainerFromCheckbox(checkbox) {\r\n    var tabContainer = checkbox.parentElement.parentElement\r\n        .nextElementSibling;\r\n    return tabContainer;\r\n}\r\n/**\r\n * Adds the metadata tab to a layer's tab container after checking to see\r\n * if the layer in question supports the LayerMetadata SOE.\r\n * @param tabContainer\r\n * @param operationalLayer\r\n * @param layerIndex\r\n * @param formatterPageUrl\r\n */\r\nfunction addMetadataTab(tabContainer, operationalLayer, layerIndex, formatterPageUrl) {\r\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n        var url, metadataSupported, mdLinks, tabId, listItem, tab, tabList, tabs, ul, name_1, mdUrl, a, li;\r\n        return tslib_1.__generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    // Exit early if there is no layer URL.\r\n                    if (!(operationalLayer && operationalLayer.layer && operationalLayer.layer.url)) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    url = operationalLayer.layer.url;\r\n                    return [4 /*yield*/, layer_metadata_soe_client_1.detectLayerMetadataSupport(url)];\r\n                case 1:\r\n                    metadataSupported = _a.sent();\r\n                    if (!metadataSupported) {\r\n                        return [2 /*return*/];\r\n                    }\r\n                    return [4 /*yield*/, layer_metadata_soe_client_1.getMetadataLinks(url)];\r\n                case 2:\r\n                    mdLinks = _a.sent();\r\n                    tabId = \"metadata\";\r\n                    listItem = document.createElement(\"li\");\r\n                    listItem.tabIndex = 0;\r\n                    listItem.dataset.tabId = tabId;\r\n                    listItem.dataset.layerIndex = layerIndex.toString(10);\r\n                    listItem.setAttribute(\"role\", \"tab\");\r\n                    listItem.classList.add(\"esriTabMenuItem\");\r\n                    listItem.textContent = \"Metadata\";\r\n                    tab = document.createElement(\"div\");\r\n                    tab.classList.add(\"esriTab\", \"metadata-panel\");\r\n                    tab.setAttribute(\"role\", \"tabpanel\");\r\n                    tab.dataset.tabId = tabId;\r\n                    tabList = tabContainer.firstElementChild;\r\n                    tabs = tabContainer.children[1];\r\n                    tabList.appendChild(listItem);\r\n                    tabs.appendChild(tab);\r\n                    ul = document.createElement(\"ul\");\r\n                    ul.classList.add(\"layer-metadata-list\");\r\n                    for (name_1 in mdLinks) {\r\n                        if (mdLinks.hasOwnProperty(name_1)) {\r\n                            mdUrl = mdLinks[name_1];\r\n                            a = document.createElement(\"a\");\r\n                            a.target = \"wsdot-metadata\";\r\n                            a.href = wrapUrlWithFormatterPage(mdUrl, formatterPageUrl);\r\n                            a.textContent = name_1;\r\n                            li = document.createElement(\"li\");\r\n                            li.appendChild(a);\r\n                            ul.appendChild(li);\r\n                        }\r\n                    }\r\n                    tab.appendChild(ul);\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n","\"use strict\";\r\n/// <reference lib=\"dom\" />\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * @package @wsdot/layer-metadata-soe-client\r\n */\r\n/** @ignore */\r\nvar validLayersUrl = \"exts/LayerMetadata/validLayers?f=json\";\r\n/** @ignore */\r\nvar layerSourcesUrl = \"exts/LayerMetadata/layerSources?f=json\";\r\n/** @ignore */\r\nvar metadataUrl = \"exts/LayerMetadata/metadata\";\r\n/**\r\n * An error returned from an ArcGIS service.\r\n * @example\r\n * // Inside async function\r\n * const response = await fetch(\"https://www.example.com/ArcGIS/rest/services/MyService/query?invalidOption=thisisinvalid\");\r\n * const obj = await response.json();\r\n * if (obj.error) {\r\n *  throw new ArcGisError(obj.error);\r\n * }\r\n */\r\nvar ArcGisError = /** @class */ (function (_super) {\r\n    __extends(ArcGisError, _super);\r\n    /**\r\n     * Creates a new instance of ArcGisError.\r\n     * @param errorInfo - The \"error\" property of the response object returned from a failed ArcGIS Server request.\r\n     */\r\n    function ArcGisError(errorInfo) {\r\n        var _this = _super.call(this, errorInfo.message) || this;\r\n        _this.errorInfo = errorInfo;\r\n        _this.code = errorInfo.code;\r\n        return _this;\r\n    }\r\n    return ArcGisError;\r\n}(Error));\r\nexports.ArcGisError = ArcGisError;\r\n/**\r\n * Gets map service info\r\n * @param serviceUrl map service URL.\r\n * @throws {ArcGisError}\r\n */\r\nfunction getServiceInfo(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var response, serviceInfo;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, fetch([serviceUrl, \"f=json\"].join(\"?\"))];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    serviceInfo = (_a.sent());\r\n                    if (serviceInfo.error) {\r\n                        throw new ArcGisError(serviceInfo.error);\r\n                    }\r\n                    return [2 /*return*/, serviceInfo];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getServiceInfo = getServiceInfo;\r\n/**\r\n * Detects if a map service supports the \"LayerMetadata\" capability.\r\n * @param serviceUrl Map or Feature service URL.\r\n * @throws {ArcGisError}\r\n */\r\nfunction detectLayerMetadataSupport(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var serviceInfo;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, getServiceInfo(serviceUrl)];\r\n                case 1:\r\n                    serviceInfo = _a.sent();\r\n                    if (!serviceInfo.supportedExtensions) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    return [2 /*return*/, /LayerMetadata/.test(serviceInfo.supportedExtensions)];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.detectLayerMetadataSupport = detectLayerMetadataSupport;\r\n/**\r\n * Gets a list of data sources\r\n * @param serviceUrl Map service URL\r\n * @returns An object keyed by data set names with values that are layer ID integers associated with those datasets.\r\n */\r\nfunction getLayerSources(serviceUrl) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var url, response, layerSources;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    url = [serviceUrl, layerSourcesUrl].join(\"/\");\r\n                    return [4 /*yield*/, fetch(url)];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    layerSources = (_a.sent());\r\n                    return [2 /*return*/, layerSources];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getLayerSources = getLayerSources;\r\n/**\r\n * Gets URLs to unique metadata items.\r\n * @param url map service URL\r\n * @param layerSources If you have already called getLayerSources, you can pass in the results here to avoid making a duplicate request.\r\n * @returns Key value pairs. Keys are table names and values are metadata URLs.\r\n */\r\nfunction getMetadataLinks(url, layerSources) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var requestUrl, output, key;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!!layerSources) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, getLayerSources(url)];\r\n                case 1:\r\n                    layerSources = _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    requestUrl = [url, metadataUrl].join(\"/\");\r\n                    output = {};\r\n                    // tslint:disable-next-line:forin\r\n                    for (key in layerSources) {\r\n                        output[key] = [requestUrl, layerSources[key][0]].join(\"/\");\r\n                    }\r\n                    return [2 /*return*/, output];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getMetadataLinks = getMetadataLinks;\r\n/**\r\n * Gets a list of valid layer IDs\r\n * @param url Map service URL\r\n * @throws {ArcGisError} Thrown if the map service returns an error.\r\n * @throws {TypeError} Thrown if HTTP request returns an object in unexpected format.\r\n */\r\nfunction getValidLayers(url) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var requestUrl, response, obj;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    requestUrl = [url, validLayersUrl].join(\"/\");\r\n                    return [4 /*yield*/, fetch(requestUrl)];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    obj = _a.sent();\r\n                    if (obj.layerIds) {\r\n                        return [2 /*return*/, obj.layerIds];\r\n                    }\r\n                    else if (obj.error) {\r\n                        throw new ArcGisError(obj.error);\r\n                    }\r\n                    else {\r\n                        throw new TypeError(\"response was not expected type: \" + JSON.stringify(obj));\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.getValidLayers = getValidLayers;\r\n","const trueStrings = [\"true\", \"on\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\nconst falseStrings = [\"false\", \"off\", \"\", \"X\"];\r\n\r\n/**\r\n * Creates a regular expression that will match if tested against a string\r\n * containing any of the strings in the input array.\r\n * @param strings An array of strings\r\n * @param exclusive Set to true to start regex with \"^\" and end with \"$\", false (or omit) otherwise.\r\n * @example\r\n * const trueStrings = [\"true\", \"on\", \"1\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\n * const falseStrings = [\"false\", \"off\", \"0\", \"\", \"X\"];\r\n * const trueRe = makeReGroup(trueStrings);\r\n * // /(?:true)|(?:on)|(?:1)|(?:)|(?:)|(?:)|(?:)|(?:)|(?:)/\r\n * const falseRe = makeReGroup(falseStrings);\r\n * // /(?:false)|(?:off)|(?:0)|(?:)|(?:X)/\r\n */\r\nexport function makeReGroup(strings: string[], exclusive?: boolean) {\r\n  let pattern = strings.map(s => `(?:${s})`).join(\"|\");\r\n  if (exclusive) {\r\n    pattern = `^(?:${pattern})$`;\r\n  }\r\n  return new RegExp(`${pattern}`, \"i\");\r\n}\r\n\r\n/**\r\n * Creates a RegExp that will match boolean values.\r\n * @param matchOnly Set to true to only match true value strings.\r\n * Set to false to only match false value strings.\r\n * Set to non-boolean (e.g., undefined or null) to match either true or false.\r\n * @param exclusive\r\n */\r\nexport function makeBooleanRe(matchOnly?: boolean | null, exclusive?: boolean) {\r\n  const parts =\r\n    matchOnly === true\r\n      ? trueStrings\r\n      : matchOnly === false\r\n        ? falseStrings\r\n        : trueStrings.concat(...falseStrings);\r\n  return makeReGroup(parts, exclusive);\r\n}\r\n","import { LayerListOperationalLayer } from \"@wsdot/grouped-layer-list\";\r\nimport ArcGISDynamicMapServiceLayer from \"esri/layers/ArcGISDynamicMapServiceLayer\";\r\nimport { makeBooleanRe } from \"./reUtils\";\r\n\r\n/**\r\n * interface common to an operational layer as well as LayerSettings.\r\n */\r\nexport interface ILayerSettings {\r\n  visible?: boolean;\r\n  visibleLayers?: number[];\r\n}\r\n\r\n/**\r\n * Stores settings for individual layers.\r\n */\r\nexport class LayerSettings implements ILayerSettings {\r\n  /**\r\n   * Converts a string from a URLSearchParams value into a LayerSettings.\r\n   * @param str a value from a URLSearchParams.\r\n   */\r\n  public static parse(str: string): LayerSettings | null {\r\n    const trueRe = makeBooleanRe(true, true);\r\n    const falseRe = makeBooleanRe(false, true);\r\n    const sublayersRe = /^\\d+(?:[\\s,]\\d+)*$/;\r\n\r\n    let visible = trueRe.test(str)\r\n      ? true\r\n      : falseRe.test(str)\r\n        ? false\r\n        : undefined;\r\n    let visibleLayers: number[] | undefined;\r\n    if (visible === undefined && sublayersRe.test(str)) {\r\n      visibleLayers = str.split(/\\D+/).map(s => parseInt(s, 10));\r\n      visible = true;\r\n    }\r\n\r\n    if (visible === null) {\r\n      return null;\r\n    }\r\n\r\n    return new LayerSettings({\r\n      visible,\r\n      visibleLayers\r\n    });\r\n  }\r\n  /** is the layer visible */\r\n  public visible?: boolean;\r\n  /** which sublayers are turned on */\r\n  public visibleLayers?: number[];\r\n\r\n  /**\r\n   * Creates a new instance\r\n   * @param options An object that implements ILayerSettings.\r\n   */\r\n  constructor(options?: ILayerSettings) {\r\n    if (options) {\r\n      this.visible = options.visible;\r\n      this.visibleLayers = options.visibleLayers;\r\n    }\r\n  }\r\n  /**\r\n   * Applies the settings to an operational layer.\r\n   * @param operationalLayer An operational layer from a layer list.\r\n   */\r\n  public apply(operationalLayer: LayerListOperationalLayer) {\r\n    const { layer } = operationalLayer;\r\n\r\n    if (!layer) {\r\n      return;\r\n    }\r\n\r\n    const refreshAbleLayer = layer as ArcGISDynamicMapServiceLayer;\r\n\r\n    if (refreshAbleLayer.suspend) {\r\n      refreshAbleLayer.suspend();\r\n    }\r\n\r\n    if (this.visible != null) {\r\n      operationalLayer.visibility = this.visible;\r\n      layer.setVisibility(this.visible);\r\n    }\r\n    if (operationalLayer.showSubLayers && this.visibleLayers) {\r\n      (layer as ArcGISDynamicMapServiceLayer).setVisibleLayers(\r\n        this.visibleLayers\r\n      );\r\n    }\r\n\r\n    if (refreshAbleLayer.resume) {\r\n      refreshAbleLayer.resume();\r\n    }\r\n  }\r\n  /**\r\n   * Converts to string for use with URLSearchParams\r\n   */\r\n  public toString() {\r\n    if (this.visible == null) {\r\n      return \"\";\r\n    }\r\n    if (!this.visible) {\r\n      return \"\";\r\n    }\r\n\r\n    if (this.visibleLayers) {\r\n      return this.visibleLayers.join(\" \");\r\n    }\r\n    return \"\";\r\n  }\r\n}\r\n","import Portal from \"esri/arcgis/Portal\";\r\n\r\nconst wsdotAgolOrgId = \"IYrj3otxNjPsrTRD\";\r\n\r\n/**\r\n * Queries ArcGIS online for WSDOT webmaps.\r\n */\r\nasync function getWebMaps() {\r\n  const portal = new Portal.Portal(\"https://www.arcgis.com\");\r\n  const queryResults = await portal.queryItems({\r\n    num: 100,\r\n    q: `orgid:${wsdotAgolOrgId} AND type:(\"Web Map\" NOT \"Application\") AND tags:\"geoportal\"`\r\n  });\r\n  const { results } = queryResults as Portal.PortalQueryResult;\r\n  return results as Portal.PortalItem[];\r\n}\r\n\r\n/**\r\n * Creates a form from which a user can reload the application with a different webmap.\r\n */\r\nexport function createWebmapIdForm() {\r\n  const queryPomise = getWebMaps();\r\n\r\n  const form = document.createElement(\"form\");\r\n  form.action = \".\";\r\n  form.classList.add(\"webmapForm\");\r\n\r\n  const input = document.createElement(\"input\");\r\n  input.name = \"webmap\";\r\n  input.id = \"webmapInput\";\r\n  input.type = \"text\";\r\n  input.required = true;\r\n  input.placeholder = \"ArcGIS webmap id\";\r\n  input.title = \"value must be hexadecimal webmap ID\";\r\n  input.pattern = /^[a-f0-9]+$/.source;\r\n\r\n  const datalist = document.createElement(\"datalist\");\r\n  datalist.id = \"webmapList\";\r\n\r\n  input.setAttribute(\"list\", datalist.id);\r\n\r\n  const button = document.createElement(\"button\");\r\n  button.type = \"submit\";\r\n  button.textContent = \"change map\";\r\n\r\n  form.appendChild(input);\r\n  form.appendChild(datalist);\r\n  form.appendChild(button);\r\n\r\n  queryPomise.then(\r\n    results => {\r\n      results.forEach(pi => {\r\n        const option = document.createElement(\"option\");\r\n        option.textContent = option.value = pi.id;\r\n        option.label = pi.title;\r\n        datalist.appendChild(option);\r\n      });\r\n    },\r\n    error => {\r\n      console.error(\"AGOL query error\", error);\r\n      const customEvent = new CustomEvent(\"webmapqueryerror\", {\r\n        detail: { error }\r\n      });\r\n      form.dispatchEvent(customEvent);\r\n    }\r\n  );\r\n\r\n  return form;\r\n}\r\n","import GroupedLayerList, {\r\n  convertLayer,\r\n  CreateMapEvent,\r\n  getGroupsFromCreateMapItem\r\n} from \"@wsdot/grouped-layer-list\";\r\nimport arcgisUtils from \"esri/arcgis/utils\";\r\nimport esriConfig from \"esri/config\";\r\nimport HomeButton from \"esri/dijit/HomeButton\";\r\nimport Extent from \"esri/geometry/Extent\";\r\nimport { createLayerLink, setOperationalLayers } from \"./searchUtils\";\r\nimport { createWebmapIdForm } from \"./WebmapSelector\";\r\n\r\nesriConfig.defaults.io.httpsDomains.push(\"wsdot.wa.gov\");\r\nesriConfig.defaults.io.corsEnabledServers.push(\r\n  \"wsdot.wa.gov\",\r\n  \"data.wsdot.wa.gov\"\r\n);\r\n\r\nconst mapInput = createWebmapIdForm();\r\n\r\n/**\r\n * Gets the map ID from URL search parameter. Returns a default value\r\n * if there is no webmap URL search parameter.\r\n */\r\nfunction getMapIDFromUrl() {\r\n  const defaultMapId = \"d2666674071e4263ac344046f09b7599\";\r\n  const re = /\\bwebmap=([a-f0-9]+)\\b/i;\r\n  const match = location.search ? location.search.match(re) : null;\r\n  if (!match) {\r\n    return defaultMapId;\r\n  }\r\n  // groupings = {};\r\n  return match[1];\r\n}\r\n\r\n/**\r\n * Gets extent from URL if one is defined there.\r\n */\r\nfunction getExtentFromUrl() {\r\n  const url = new URL(location.href);\r\n  const extStr = url.searchParams.get(\"map-extent\");\r\n  if (!extStr) {\r\n    return undefined;\r\n  }\r\n\r\n  const [xmin, ymin, xmax, ymax] = extStr\r\n    .split(/[\\s,]/g)\r\n    .map(s => parseFloat(s));\r\n\r\n  const extent = new Extent({\r\n    xmin,\r\n    ymin,\r\n    xmax,\r\n    ymax,\r\n    spatialReference: { wkid: 4326 }\r\n  });\r\n  return extent;\r\n}\r\n\r\n// Set default map ID.\r\n// Override default map ID if one is defined in URL search params.\r\nconst mapId = getMapIDFromUrl();\r\n\r\n// Create the map using AGOL webmap.\r\narcgisUtils\r\n  .createMap(mapId, \"map\", {\r\n    mapOptions: {\r\n      extent: getExtentFromUrl() || undefined\r\n    }\r\n  })\r\n  .then((evt: CreateMapEvent) => {\r\n    const { map, itemInfo, errors } = evt;\r\n\r\n    const mapButtonDiv = document.createElement(\"button\");\r\n    mapButtonDiv.id = \"homeButton\";\r\n    map.root.appendChild(mapButtonDiv);\r\n\r\n    const homeButton = new HomeButton(\r\n      {\r\n        visible: true,\r\n        map\r\n      },\r\n      mapButtonDiv\r\n    );\r\n    homeButton.startup();\r\n\r\n    map.root.appendChild(mapInput);\r\n\r\n    // get the groupings defined in ArcGIS Online webmap item.\r\n    const groupings = getGroupsFromCreateMapItem(itemInfo) || undefined;\r\n\r\n    // If there were errors creating the map, write them to the console.\r\n    if (errors && errors.length > 0) {\r\n      console.group(\"create map error\");\r\n      errors.forEach(e => console.error(e));\r\n      console.groupEnd();\r\n    }\r\n\r\n    // Convert operational layers from the format returned by the createMap function\r\n    // To the format needed by the LayerList constructor.\r\n    // const layers = arcgisUtils.getLayerList(evt) as LayerListOperationalLayer[];\r\n    const layers = itemInfo.itemData.operationalLayers.map(convertLayer);\r\n\r\n    // Create the layer list.\r\n    const layerList = new GroupedLayerList(\r\n      {\r\n        groups: groupings,\r\n        groupProperty: \"title\",\r\n        map,\r\n        metadata: true,\r\n        layers,\r\n        throwOnGroupNotFound: false\r\n      },\r\n      \"layerList\"\r\n    );\r\n\r\n    createLayerLink(layerList);\r\n\r\n    const urlSupported = window.URL && window.URLSearchParams && window.history;\r\n\r\n    if (urlSupported) {\r\n      layerList.on(\"load\", () => {\r\n        const url = new URL(location.href);\r\n        const { searchParams } = url;\r\n        if (searchParams) {\r\n          setOperationalLayers(searchParams, layerList);\r\n        }\r\n      });\r\n    }\r\n\r\n    layerList.startup();\r\n  })\r\n  // Handle errors from CreateMap function.\r\n  .catch((err: Error) => {\r\n    console.error(\"map creation error\", err);\r\n  });\r\n","import { LayerListOperationalLayer } from \"@wsdot/grouped-layer-list\";\r\nimport LayerList from \"esri/dijit/LayerList\";\r\nimport Extent from \"esri/geometry/Extent\";\r\nimport webMercatorUtils from \"esri/geometry/webMercatorUtils\";\r\nimport { LayerSettings } from \"./LayerSettings\";\r\n\r\n/**\r\n * Updates the layers' settings to match those from URL search parameters.\r\n * @param search URL search string\r\n * @param opLayers Operational layers\r\n */\r\nexport function setOperationalLayers(\r\n  search: URLSearchParams,\r\n  layerList: LayerList\r\n) {\r\n  if (!search || !window.URLSearchParams) {\r\n    return;\r\n  }\r\n\r\n  const opLayers = layerList.layers as LayerListOperationalLayer[];\r\n\r\n  for (const opLayer of opLayers) {\r\n    // Skip if layer has no corresponding entry in URLSearchParams.\r\n    if (!opLayer.id || !search.has(opLayer.id)) {\r\n      continue;\r\n    }\r\n\r\n    const val = search.get(opLayer.id);\r\n    if (!val) {\r\n      // Skip if there is no value. (E.g., value is empty string.)\r\n      continue;\r\n    }\r\n\r\n    // parse string value into layer settings object.\r\n    const layerSettings = LayerSettings.parse(val);\r\n    if (!layerSettings) {\r\n      // tslint:disable-next-line:no-console\r\n      console.warn(\r\n        `could not parse \"${val}\" into layer settings for layer ${opLayer.id}.`\r\n      );\r\n      continue;\r\n    }\r\n\r\n    layerSettings.apply(opLayer);\r\n  }\r\n}\r\n\r\n/**\r\n * Creates a link on the map that will, when clicked, copy the URL of the page with\r\n * URL search parameters\r\n * @param layerList\r\n */\r\nexport function createLayerLink(layerList: LayerList) {\r\n  const urlSupported = window.URL && window.URLSearchParams && window.history;\r\n  if (!urlSupported) {\r\n    throw new Error(\r\n      \"Browser must support all of the following features: URL, URLSearchParams, history.\"\r\n    );\r\n  }\r\n\r\n  const div = document.createElement(\"div\");\r\n  div.classList.add(\"layer-link\");\r\n\r\n  const a = document.createElement(\"a\");\r\n  a.href = new URL(\r\n    location.href,\r\n    location.href.replace(/\\?.+$/, \"\")\r\n  ).toString();\r\n  a.textContent = \"\";\r\n  a.title = \"copy URL with layer settings to clipboard\";\r\n  a.target = \"_blank\";\r\n  a.classList.add(\"layer-link__anchor\");\r\n\r\n  const copiedClass = \"layer-link-copied\";\r\n  const disabledClass = \"layer-link-disabled\";\r\n\r\n  div.classList.add(disabledClass);\r\n\r\n  div.appendChild(a);\r\n\r\n  layerList.map.on(\"extent-change\", ({ extent }) => {\r\n    extent = webMercatorUtils.webMercatorToGeographic(extent) as Extent;\r\n    const { xmin, ymin, xmax, ymax } = extent;\r\n    const searchValue = [xmin, ymin, xmax, ymax]\r\n      .map(n => {\r\n        return Math.round(n * 10000) / 10000;\r\n      })\r\n      .join(\" \");\r\n    const url = new URL(a.href);\r\n    url.searchParams.set(\"map-extent\", searchValue);\r\n    a.href = url.toString();\r\n    div.classList.remove(disabledClass);\r\n  });\r\n\r\n  layerList.on(\"toggle\", function(this: HTMLDivElement, toggleEvent) {\r\n    // Enable and turn off copied status.\r\n    div.classList.remove(copiedClass);\r\n    div.classList.remove(disabledClass);\r\n    const { layerIndex, visible, subLayerIndex } = toggleEvent;\r\n\r\n    // Get the operational layer from the layer list based on the event's layerIndex.\r\n    const operationalLayer = layerList.layers[\r\n      layerIndex\r\n    ] as LayerListOperationalLayer;\r\n\r\n    // Get the URL currently in the link's href attribute.\r\n    // Store in URL object so that search params can be\r\n    // easily searched and manipulated.\r\n    const url = new URL(a.href);\r\n\r\n    // Retrieve the current settings store in the URL for this layer.\r\n    // If there are no settings, the old settings variable will be null.\r\n    const oldSettingStr = url.searchParams.get(operationalLayer.id!);\r\n    const oldSettings = oldSettingStr\r\n      ? LayerSettings.parse(oldSettingStr)\r\n      : null;\r\n\r\n    // Detect if the settings for this layer had sublayers specified.\r\n    const hadSublayersDefined = oldSettings\r\n      ? oldSettings.visibleLayers != null\r\n      : false;\r\n\r\n    // Initialize layer settings object.\r\n    let layerSettings: LayerSettings;\r\n\r\n    // Layer settings string for the URL will simply indicate if\r\n    // the parent layer is on or off except under these conditions:\r\n    // * Ability to change sublayer visibility is enabled for current layer.\r\n    // * User changed visibility of sublayer via UI or sublayer visibility\r\n    //   had been previously set in the URL.\r\n    if (\r\n      operationalLayer.showSubLayers &&\r\n      (hadSublayersDefined || subLayerIndex != null)\r\n    ) {\r\n      layerSettings = new LayerSettings(operationalLayer.layer);\r\n    } else {\r\n      layerSettings = new LayerSettings({ visible });\r\n    }\r\n\r\n    // Update the URL search parameter for this layer and assign updated URL to link's href.\r\n    url.searchParams.set(operationalLayer.id!, layerSettings.toString());\r\n    a.href = url.toString();\r\n  });\r\n\r\n  // Setup link click event. When link is clicked\r\n  a.onclick = function(this, e) {\r\n    const unsupportedMessage =\r\n      \"Could not copy to clipboard. Right-click link and use context menu to copy link.\";\r\n\r\n    const clipboard: any = (navigator as any).clipboard;\r\n    // If browser doesn't support clipboard, show an alert.\r\n    if (!(clipboard && clipboard.writeText)) {\r\n      alert(unsupportedMessage);\r\n      return false;\r\n    }\r\n    // Copy link's href value to clipboard.\r\n    // If successful, add a class for CSS to style to indicate success.\r\n    // If copy fails, show an alert.\r\n    clipboard.writeText(a.href).then(\r\n      () => {\r\n        div.classList.add(copiedClass);\r\n      },\r\n      (clipErr: Error) => {\r\n        alert(unsupportedMessage);\r\n      }\r\n    );\r\n    return false;\r\n  };\r\n\r\n  const mapRoot = layerList.map.root as HTMLElement;\r\n\r\n  mapRoot.appendChild(div);\r\n}\r\n"],"sourceRoot":""}