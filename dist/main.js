define(["esri/dijit/LayerList","esri/geometry/webMercatorUtils","dijit/layout/BorderContainer","dijit/layout/ContentPane","esri/arcgis/utils","esri/config","esri/dijit/HomeButton","esri/geometry/Extent","esri/arcgis/Portal"],function(e,t,r,n,o,a,i,u,c){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return l}),r.d(t,"__awaiter",function(){return s}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return y}),r.d(t,"__spread",function(){return h}),r.d(t,"__await",function(){return v}),r.d(t,"__asyncGenerator",function(){return m}),r.d(t,"__asyncDelegator",function(){return b}),r.d(t,"__asyncValues",function(){return w}),r.d(t,"__makeTemplateObject",function(){return _}),r.d(t,"__importStar",function(){return g}),r.d(t,"__importDefault",function(){return x});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function s(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}c((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{(r=o[e](t)).value instanceof v?Promise.resolve(r.value.v).then(c,l):s(a[0][2],r)}catch(e){s(a[0][3],e)}var r}function c(e){u("next",e)}function l(e){u("throw",e)}function s(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:v(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return l}),r.d(t,"__awaiter",function(){return s}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return y}),r.d(t,"__spread",function(){return h}),r.d(t,"__await",function(){return v}),r.d(t,"__asyncGenerator",function(){return m}),r.d(t,"__asyncDelegator",function(){return b}),r.d(t,"__asyncValues",function(){return w}),r.d(t,"__makeTemplateObject",function(){return _}),r.d(t,"__importStar",function(){return g}),r.d(t,"__importDefault",function(){return x});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function s(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}c((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{(r=o[e](t)).value instanceof v?Promise.resolve(r.value.v).then(c,l):s(a[0][2],r)}catch(e){s(a[0][3],e)}var r}function c(e){u("next",e)}function l(e){u("throw",e)}function s(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:v(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){function t(t,r){return e.call(this,'"'+t+'" does not match expected format: "'+r+'".')||this}return n.__extends(t,e),t}(Error);t.FormatError=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(4)),a=n.__importDefault(r(12)),i=n.__importDefault(r(13)),u=n.__importDefault(r(14)),c=n.__importDefault(r(15)),l=n.__importDefault(r(16)),s=n.__importDefault(r(17)),f=r(2),d=r(18),p=r(19);c.default.defaults.io.httpsDomains.push("wsdot.wa.gov"),c.default.defaults.io.corsEnabledServers.push("wsdot.wa.gov","data.wsdot.wa.gov");var y=new a.default({liveSplitters:!0},"container"),h=new i.default({region:"left",style:"width: 300px; padding: 0",splitter:!0},"layerListContainer"),v=new i.default({region:"center",style:"padding: 0"},"mapContainer");y.addChild(h),y.addChild(v),y.startup();var m=p.createWebmapIdForm();var b,w=(b=location.search?location.search.match(/\bwebmap=([a-f0-9]+)\b/i):null)?b[1]:"d2666674071e4263ac344046f09b7599";u.default.createMap(w,"map",{mapOptions:{extent:function(){var e=new URL(location.href).searchParams.get("map-extent");if(e){var t=n.__read(e.split(/[\s,]/g).map(function(e){return parseFloat(e)}),4),r=t[0],o=t[1],a=t[2],i=t[3];return new s.default({xmin:r,ymin:o,xmax:a,ymax:i,spatialReference:{wkid:4326}})}}()||void 0}}).then(function(e){var t=e.map,r=e.itemInfo,n=e.errors,a=document.createElement("button");a.id="homeButton",t.root.appendChild(a),new l.default({visible:!0,map:t},a).startup(),t.root.appendChild(m);var i=o.getGroupsFromCreateMapItem(r)||void 0;n&&n.length>0&&(console.group("create map error"),n.forEach(function(e){return console.error(e)}),console.groupEnd());var u=r.itemData.operationalLayers.map(o.convertLayer),c=new o.default({groups:i,groupProperty:"title",map:t,metadata:!0,layers:u,throwOnGroupNotFound:!1},"layerList");o.createLayerLink(c),window.URL&&window.URLSearchParams&&window.history&&c.on("load",function(){var e=new URL(location.href).searchParams;e&&o.setOperationalLayers(e,c)}),c.startup();try{var s=d.createSourceLink("https://www.github.com/wsdot-gis/grouped-layer-list");t.root.appendChild(s)}catch(e){if(!(e instanceof f.FormatError))throw e}}).catch(function(e){console.error("map creation error",e)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=n.__importDefault(r(5)),a=r(6);function i(e,t){var r,o=("string"==typeof e?document.getElementById(e):e).querySelectorAll(".esriList > li"),a=function(e){var t=new Map,r=function(r){e.hasOwnProperty(r)&&e[r].forEach(function(e){return t.set(e,r)})};for(var n in e)r(n);return t}(t),i=0,u=new Map;return Array.from(o,function(e){var t=e.querySelector("label");if(t){var n=t.textContent,o=a.get(n)||"Other";if(o!==r){var c="layer-list-group-"+i;u.set(c,o),e.classList.add("layer-list-group-start",c),i++}r=o}}),Array.from(u,function(e){var t=n.__read(e,2);return"."+t[0]+":before { content: '"+t[1]+"' }"}).join("\n")}n.__exportStar(r(8),t),t.getGroupsFromCreateMapItem=function(e){if(e.itemData.applicationProperties){var t=e.itemData.applicationProperties;if(t.viewing){var r=t.viewing;if(r.layerGrouping){var n=r.layerGrouping;if(n&&n.enabled&&n.groups)return n.groups}}}return null},t.convertLayer=function(e){var t=e.id,r=e.title,n=e.visibility,o=e.layerObject;return{id:t,title:r,layer:o,visibility:n,showLegend:!0,showOpacitySlider:!0,showSubLayers:!o.layerInfos||o.layerInfos.length>1}};var u=function(e){function t(t,r){var o=this;if(t.groups){var u=t.layers,c=new(Array.bind.apply(Array,n.__spread([void 0],function(e,t,r,o){var a,i,u,c,l,s,f,d,p,y,h,v;return void 0===r&&(r="id"),n.__generator(this,function(m){switch(m.label){case 0:for(c in u=[],e)u.push(c);l=0,m.label=1;case 1:if(!(l<u.length))return[3,10];if(s=u[l],!e.hasOwnProperty(s))return[3,9];f=e[s],d=function(e){var a,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!(a=t.find(function(t){return t[r]===e}))){if(i='No layer found with "'+r+'" of "'+e+'".',o)throw new ReferenceError(i);return console.warn(i),[2,"continue"]}return[4,a];case 1:return n.sent(),[2]}})},m.label=2;case 2:m.trys.push([2,7,8,9]),p=n.__values(f),y=p.next(),m.label=3;case 3:return y.done?[3,6]:(h=y.value,[5,d(h)]);case 4:m.sent(),m.label=5;case 5:return y=p.next(),[3,3];case 6:return[3,9];case 7:return v=m.sent(),a={error:v},[3,9];case 8:try{y&&!y.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}return[7];case 9:return l++,[3,1];case 10:return[2]}})}(t.groups,t.layers,t.groupProperty,t.throwOnGroupNotFound))));u.filter(function(e){return!c.includes(e)}).forEach(function(e){return c.push(e)}),t.layers=c.reverse()}return o=e.call(this,t,r)||this,t.groups&&o.on("load",function(e){var n=i(r,t.groups),o=document.createElement("style");o.textContent=n,document.head.appendChild(o)}),t.metadata&&a.addMetadataTabs(o,t.metadataFormatterPage||void 0),o}return n.__extends(t,e),t}(o.default);t.default=u},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(7),a="https://wsdot-gis.github.io/geospatial-metadata";function i(e,t){return void 0===t&&(t=a),t?t+"?"+("url="+encodeURIComponent(e+"?f=xml")):e}t.addMetadataTabs=function(e,t){void 0===t&&(t=a),e.on("load",function(r){var a=r.target.querySelectorAll(".esriTitleContainer > input[type=checkbox]");Array.from(a,function(r){r.addEventListener("click",function(r){if(this.dataset.layerIndex){var a,u=parseInt(this.dataset.layerIndex,10),c=e.layers[u];try{a=this.parentElement.parentElement.nextElementSibling}catch(e){if(!(e instanceof TypeError))throw e}a&&function(e,t,r,a){n.__awaiter(this,void 0,void 0,function(){var u,c,l,s,f,d,p,y,h,v,m;return n.__generator(this,function(n){switch(n.label){case 0:return t&&t.layer&&t.layer.url?(u=t.layer.url,[4,o.detectLayerMetadataSupport(u)]):[2];case 1:return n.sent()?[4,o.getMetadataLinks(u)]:[2];case 2:for(y in c=n.sent(),(l=document.createElement("li")).tabIndex=0,l.dataset.tabId="metadata",l.dataset.layerIndex=r.toString(10),l.setAttribute("role","tab"),l.classList.add("esriTabMenuItem"),l.textContent="Metadata",(s=document.createElement("div")).classList.add("esriTab","metadata-panel"),s.setAttribute("role","tabpanel"),s.dataset.tabId="metadata",f=e.firstElementChild,d=e.children[1],f.appendChild(l),d.appendChild(s),(p=document.createElement("ul")).classList.add("layer-metadata-list"),c)c.hasOwnProperty(y)&&(h=c[y],(v=document.createElement("a")).target="wsdot-metadata",v.href=i(h,a),v.textContent=y,(m=document.createElement("li")).appendChild(v),p.appendChild(m));return s.appendChild(p),[2]}})})}(a,c,u,t)}},{once:!0,passive:!0})})})}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,u)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var u="exts/LayerMetadata/validLayers?f=json",c="exts/LayerMetadata/layerSources?f=json",l="exts/LayerMetadata/metadata",s=function(e){function t(t){var r=e.call(this,t.message)||this;return r.errorInfo=t,r.code=t.code,r}return o(t,e),t}(Error);function f(e){return a(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,fetch([e,"f=json"].join("?"))];case 1:return[4,r.sent().json()];case 2:if((t=r.sent()).error)throw new s(t.error);return[2,t]}})})}function d(e){return a(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return t=[e,c].join("/"),[4,fetch(t)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}})})}t.ArcGisError=s,t.getServiceInfo=f,t.detectLayerMetadataSupport=function(e){return a(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,f(e)];case 1:return(t=r.sent()).supportedExtensions?[2,/LayerMetadata/.test(t.supportedExtensions)]:[2,!1]}})})},t.getLayerSources=d,t.getMetadataLinks=function(e,t){return a(this,void 0,void 0,function(){var r,n,o;return i(this,function(a){switch(a.label){case 0:return t?[3,2]:[4,d(e)];case 1:t=a.sent(),a.label=2;case 2:for(o in r=[e,l].join("/"),n={},t)n[o]=[r,t[o][0]].join("/");return[2,n]}})})},t.getValidLayers=function(e){return a(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return t=[e,u].join("/"),[4,fetch(t)];case 1:return[4,n.sent().json()];case 2:if((r=n.sent()).layerIds)return[2,r.layerIds];throw r.error?new s(r.error):new TypeError("response was not expected type: "+JSON.stringify(r))}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=n.__importDefault(r(9)),a=r(10);t.setOperationalLayers=function(e,t){var r,o;if(e&&window.URLSearchParams){var i=t.layers;try{for(var u=n.__values(i),c=u.next();!c.done;c=u.next()){var l=c.value;if(l.id&&e.has(l.id)){var s=e.get(l.id);if(s){var f=a.LayerSettings.parse(s);f?f.apply(l):console.warn('could not parse "'+s+'" into layer settings for layer '+l.id+".")}}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}},t.createLayerLink=function(e){if(!(window.URL&&window.URLSearchParams&&window.history))throw new Error("Browser must support all of the following features: URL, URLSearchParams, history.");var t=document.createElement("div");t.classList.add("layer-link");var r=document.createElement("a");r.href=new URL(location.href,location.href.replace(/\?.+$/,"")).toString(),r.textContent="📋",r.title="copy URL with layer settings to clipboard",r.target="_blank",r.classList.add("layer-link__anchor"),t.classList.add("layer-link--disabled"),t.appendChild(r),e.map.on("extent-change",function(e){var n=e.extent,a=[(n=o.default.webMercatorToGeographic(n)).xmin,n.ymin,n.xmax,n.ymax].map(function(e){return Math.round(1e4*e)/1e4}).join(" "),i=new URL(r.href);i.searchParams.set("map-extent",a),r.href=i.toString(),t.classList.remove("layer-link--disabled"),t.classList.remove("layer-link--copied")}),e.on("toggle",function(n){t.classList.remove("layer-link--copied"),t.classList.remove("layer-link--disabled");var o,i=n.layerIndex,u=n.visible,c=n.subLayerIndex,l=e.layers[i],s=new URL(r.href),f=s.searchParams.get(l.id),d=f?a.LayerSettings.parse(f):null,p=!!d&&null!=d.visibleLayers;o=l.showSubLayers&&(p||null!=c)?new a.LayerSettings(l.layer):new a.LayerSettings({visible:u}),s.searchParams.set(l.id,o.toString()),r.href=s.toString()}),r.onclick=function(e){var n="Could not copy to clipboard. Right-click link and use context menu to copy link.",o=navigator.clipboard;return o&&o.writeText?(o.writeText(r.href).then(function(){t.classList.add("layer-link--copied")},function(e){alert(n)}),!1):(alert(n),!1)},e.map.root.appendChild(t)}},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=function(){function e(e){e&&(this.visible=e.visible,this.visibleLayers=e.visibleLayers)}return e.parse=function(t){var r,o=n.makeBooleanRe(!0,!0),a=n.makeBooleanRe(!1,!0),i=!!o.test(t)||!a.test(t)&&void 0;return void 0===i&&/^\d+(?:[\s,]\d+)*$/.test(t)&&(r=t.split(/\D+/).map(function(e){return parseInt(e,10)}),i=!0),null===i?null:new e({visible:i,visibleLayers:r})},e.prototype.apply=function(e){var t=e.layer;if(t){var r=t;r.suspend&&r.suspend(),null!=this.visible&&(e.visibility=this.visible,t.setVisibility(this.visible)),e.showSubLayers&&this.visibleLayers&&t.setVisibleLayers(this.visibleLayers),r.resume&&r.resume()}},e.prototype.toString=function(){return null==this.visible?"":this.visible?this.visibleLayers?this.visibleLayers.join(" "):"✓":"⍻"},e}();t.LayerSettings=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=["true","on","✓","✔","🗸","🗹","☑","✅"],a=["false","off","⍻","X"];function i(e,t){var r=e.map(function(e){return"(?:"+e+")"}).join("|");return t&&(r="^(?:"+r+")$"),new RegExp(""+r,"i")}t.makeReGroup=i,t.makeBooleanRe=function(e,t){return i(!0===e?o:!1===e?a:o.concat.apply(o,n.__spread(a)),t)}},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t){e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2);function a(e){void 0===e&&(e=location.href);var t=/https?\:\/\/([^\.]+)\.github.io\/([^\/]+)/i,r=e.match(t);if(!r)throw new o.FormatError(e,t);var a=n.__read(r,3);return"https://www.github.com/"+a[1]+"/"+a[2]}t.ghPagesToGithubUrl=a,t.githubToGHPagesUrl=function(e){void 0===e&&(e=location.href);var t=/https?\:\/\/www.github.com\/([^\/]+)\/([^\/]+)/,r=e.match(t);if(!r)throw new o.FormatError(e,t);var a=n.__read(r,3);return"https://"+a[1]+".github.io/"+a[2]},t.createSourceLink=function(e){e=e||a();var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="nofollow";var r=document.createElement("span");return r.textContent="Source on GitHub",t.classList.add("github-link"),r.classList.add("github-link__label"),t.appendChild(r),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(20)),a="IYrj3otxNjPsrTRD";t.createWebmapIdForm=function(e){void 0===e&&(e="select");var t=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,new o.default.Portal("https://www.arcgis.com").queryItems({num:100,q:"orgid:"+a+' AND type:("Web Map" NOT "Application") AND tags:"geoportal"'})];case 1:return[2,e.sent().results]}})})}(),r=document.createElement("form");r.action=".",r.classList.add("webmapForm");var i,u,c,l=document.createElement("progress");r.appendChild(l),"select"===e?((i=document.createElement("select")).disabled=!0,i.innerHTML="<option disabled selected>change map</option>",i.name="webmap",r.appendChild(i)):((u=document.createElement("input")).name="webmap",u.id="webmapInput",u.type="text",u.required=!0,u.placeholder="ArcGIS webmap id",u.title="value must be hexadecimal webmap ID",u.pattern=/^[a-f0-9]+$/.source,(c=document.createElement("datalist")).id="webmapList",r.appendChild(u),r.appendChild(c),u.setAttribute("list",c.id));var s=document.createElement("button");return s.type="submit",s.textContent="change map",r.appendChild(s),t.then(function(e){(i||u).disabled=!1,e.forEach(function(e){var t=document.createElement("option");t.textContent=t.value=e.id,t.label=e.title,(i||c).appendChild(t)}),r.removeChild(l)},function(e){console.error("AGOL query error",e);var t=new CustomEvent("webmapqueryerror",{detail:{error:e}});r.dispatchEvent(t),r.removeChild(l)}),r}},function(e,t){e.exports=c}])});
//# sourceMappingURL=main.js.map