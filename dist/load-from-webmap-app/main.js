define(["esri/dijit/LayerList","esri/geometry/webMercatorUtils","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","dijit/layout/BorderContainer","dijit/layout/ContentPane","esri/arcgis/utils","esri/config","esri/dijit/HomeButton","esri/geometry/Extent","esri/arcgis/Portal"],function(e,t,r,n,a,o,i,u,s,c,l){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return a}),r.d(t,"__assign",function(){return o}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return s}),r.d(t,"__metadata",function(){return c}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return d}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return y}),r.d(t,"__spread",function(){return h}),r.d(t,"__await",function(){return v}),r.d(t,"__asyncGenerator",function(){return m}),r.d(t,"__asyncDelegator",function(){return b}),r.d(t,"__asyncValues",function(){return w}),r.d(t,"__makeTemplateObject",function(){return _}),r.d(t,"__importStar",function(){return g}),r.d(t,"__importDefault",function(){return x});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(r[n[a]]=e[n[a]])}return r}function u(e,t,r,n){var a,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function s(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){a[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{(r=a[e](t)).value instanceof v?Promise.resolve(r.value.v).then(s,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function s(e){u("next",e)}function c(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:v(e[n](t)),done:"return"===n}:a?a(t):t}:a}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,a){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,a,(t=e[r](t)).done,t.value)})}}}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=function(e){function t(t,r){return e.call(this,'"'+t+'" does not match expected format: "'+r+'".')||this}return n.__extends(t,e),t}(Error);t.FormatError=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=n.__importStar(r(3)),o=n.__importDefault(r(14)),i=n.__importDefault(r(15)),u=n.__importDefault(r(16)),s=n.__importDefault(r(17)),c=n.__importDefault(r(18)),l=n.__importDefault(r(19)),f=r(1),d=r(20),p=r(21);s.default.defaults.io.httpsDomains.push("wsdot.wa.gov"),s.default.defaults.io.corsEnabledServers.push("wsdot.wa.gov","data.wsdot.wa.gov");var y=new o.default({liveSplitters:!0},"container"),h=new i.default({region:"left",style:"width: 300px; padding: 0",splitter:!0},"layerListContainer"),v=new i.default({region:"center",style:"padding: 0"},"mapContainer");y.addChild(h),y.addChild(v),y.startup();var m=p.createWebmapIdForm();var b,w=(b=location.search?location.search.match(/\bwebmap=([a-f0-9]+)\b/i):null)?b[1]:"d2666674071e4263ac344046f09b7599";u.default.createMap(w,"map",{mapOptions:{extent:function(){var e=new URL(location.href).searchParams.get("map-extent");if(e){var t=n.__read(e.split(/[\s,]/g).map(function(e){return parseFloat(e)}),4),r=t[0],a=t[1],o=t[2],i=t[3];return new l.default({xmin:r,ymin:a,xmax:o,ymax:i,spatialReference:{wkid:4326}})}}()||void 0}}).then(function(e){var t=e.map,r=e.itemInfo,n=e.errors,o=document.createElement("button");o.id="homeButton",t.root.appendChild(o),new c.default({visible:!0,map:t},o).startup(),t.root.appendChild(m);var i=a.getGroupsFromCreateMapItem(r)||void 0;n&&n.length>0&&(console.group("create map error"),n.forEach(function(e){return console.error(e)}),console.groupEnd());var u=r.itemData.operationalLayers.map(a.convertLayer);if(window.URL&&window.URLSearchParams&&window.history){var s=new URL(location.href).searchParams;s&&a.setOperationalLayers(s,u)}var l=new a.default({groups:i,groupProperty:"title",map:t,metadata:!0,layers:u,throwOnGroupNotFound:!1},"layerList");a.createLayerLink(l),l.startup();try{var p=d.createSourceLink("https://www.github.com/wsdot-gis/grouped-layer-list");t.root.appendChild(p)}catch(e){if(!(e instanceof f.FormatError))throw e}}).catch(function(e){console.error("map creation error",e)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=n.__importDefault(r(4)),o=r(5);function i(e,t){var r="string"==typeof e?document.getElementById(e):e;r.id&&(r=document.getElementById(r.id)||r);var a,o=r.querySelectorAll(".esriList > li"),i=function(e){var t=new Map,r=function(r){e.hasOwnProperty(r)&&e[r].forEach(function(e){return t.set(e,r)})};for(var n in e)r(n);return t}(t),u=0,s=new Map;return Array.from(o,function(e){var t=e.querySelector("label");if(t){var r=t.textContent,n=i.get(r)||"Other";if(n!==a){var o="layer-list-group-"+u;s.set(o,n),e.classList.add("layer-list-group-start",o),u++}a=n}}),Array.from(s,function(e){var t=n.__read(e,2);return"."+t[0]+":before { content: '"+t[1]+"' }"}).join("\n")}n.__exportStar(r(7),t),n.__exportStar(r(11),t),t.getGroupsFromCreateMapItem=function(e){if(e.itemData.applicationProperties){var t=e.itemData.applicationProperties;if(t.viewing){var r=t.viewing;if(r.layerGrouping){var n=r.layerGrouping;if(n&&n.enabled&&n.groups)return n.groups}}}return null},t.convertLayer=function(e){var t=e.id,r=e.title,n=e.visibility,a=e.layerObject;return{id:t,title:r,layer:a,visibility:n,showLegend:!0,showOpacitySlider:!0,showSubLayers:!a.layerInfos||a.layerInfos.length>1}};var u=function(e){function t(t,r){var a=this;if(t.groups){var u=t.layers,s=new(Array.bind.apply(Array,n.__spread([void 0],function(e,t,r,a){var o,i,u,s,c,l,f,d,p,y,h,v;return void 0===r&&(r="id"),n.__generator(this,function(m){switch(m.label){case 0:for(s in u=[],e)u.push(s);c=0,m.label=1;case 1:if(!(c<u.length))return[3,10];if(l=u[c],!e.hasOwnProperty(l))return[3,9];f=e[l],d=function(e){var o,i;return n.__generator(this,function(n){switch(n.label){case 0:if(!(o=t.find(function(t){return t[r]===e}))){if(i='No layer found with "'+r+'" of "'+e+'".',a)throw new ReferenceError(i);return console.warn(i),[2,"continue"]}return[4,o];case 1:return n.sent(),[2]}})},m.label=2;case 2:m.trys.push([2,7,8,9]),p=n.__values(f),y=p.next(),m.label=3;case 3:return y.done?[3,6]:(h=y.value,[5,d(h)]);case 4:m.sent(),m.label=5;case 5:return y=p.next(),[3,3];case 6:return[3,9];case 7:return v=m.sent(),o={error:v},[3,9];case 8:try{y&&!y.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}return[7];case 9:return c++,[3,1];case 10:return[2]}})}(t.groups,t.layers,t.groupProperty,t.throwOnGroupNotFound))));u.filter(function(e){return!s.includes(e)}).forEach(function(e){return s.push(e)}),t.layers=s.reverse()}var c="string"===r?r:r instanceof HTMLElement?r.id:null;return(a=e.call(this,t,r)||this)._nodeId=c||"string"==typeof r?r:r.id,t.groups&&a.on("load",function(e){var n=i(r,t.groups),a=document.createElement("style");a.textContent=n,document.head.appendChild(a)}),t.metadata&&o.addMetadataTabs(a,t.metadataFormatterPage||void 0),a}return n.__extends(t,e),Object.defineProperty(t.prototype,"root",{get:function(){return document.getElementById(this._nodeId)},enumerable:!0,configurable:!0}),t}(a.default);t.default=u},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(6),o="https://wsdot-gis.github.io/geospatial-metadata";function i(e,t){return void 0===t&&(t=o),t?t+"?"+("url="+encodeURIComponent(e+"?f=xml")):e}function u(e){var t=e.match(/^([^\.]+)\.([^\.]+)\.([^\.]+)$/i);if(t){var r=n.__read(t,4),a=r[1],o=r[2],i=r[3],u=document.createElement("span"),s=document.createElement("span"),c=document.createElement("span");u.textContent=a,s.textContent=o,c.textContent=i,u.classList.add("metadata-source-name__db"),s.classList.add("metadata-source-name__schema"),c.classList.add("metadata-source-name__table");var l=document.createDocumentFragment();return[u,s,c].forEach(function(e){l.appendChild(e)}),l}return document.createTextNode(e)}t.addMetadataTabs=function(e,t){void 0===t&&(t=o),e.on("load",function(r){var o=r.target.querySelectorAll(".esriTitleContainer > input[type=checkbox]");function s(r){if(r.dataset.layerIndex){var o,s=parseInt(r.dataset.layerIndex,10),c=e.layers[s];try{o=function(e){return e.parentElement.parentElement.nextElementSibling}(r)}catch(e){if(!(e instanceof TypeError))throw e}o&&function(e,t,r,o){n.__awaiter(this,void 0,void 0,function(){var s,c,l,f,d,p,y,h,v,m,b;return n.__generator(this,function(n){switch(n.label){case 0:return t&&t.layer&&t.layer.url?(s=t.layer.url,[4,a.detectLayerMetadataSupport(s)]):[2];case 1:return n.sent()?[4,a.getMetadataLinks(s)]:[2];case 2:for(h in c=n.sent(),(l=document.createElement("li")).tabIndex=0,l.dataset.tabId="metadata",l.dataset.layerIndex=r.toString(10),l.setAttribute("role","tab"),l.classList.add("esriTabMenuItem"),l.textContent="Metadata",(f=document.createElement("div")).classList.add("esriTab","metadata-panel"),f.setAttribute("role","tabpanel"),f.dataset.tabId="metadata",d=e.firstElementChild,p=e.children[1],d.appendChild(l),p.appendChild(f),(y=document.createElement("ul")).classList.add("layer-metadata-list"),c)c.hasOwnProperty(h)&&(v=c[h],(m=document.createElement("a")).target="wsdot-metadata",m.href=i(v,o),m.appendChild(u(h)),(b=document.createElement("li")).appendChild(m),y.appendChild(b));return f.appendChild(y),[2]}})})}(o,c,s,t)}}Array.from(o,function(e){e.checked?s(e):e.addEventListener("click",function(e){s(this)},{once:!0,passive:!0})})})}},function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(i,u)}s((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var u="exts/LayerMetadata/validLayers?f=json",s="exts/LayerMetadata/layerSources?f=json",c="exts/LayerMetadata/metadata",l=function(e){function t(t){var r=e.call(this,t.message)||this;return r.errorInfo=t,r.code=t.code,r}return a(t,e),t}(Error);function f(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,fetch([e,"f=json"].join("?"))];case 1:return[4,r.sent().json()];case 2:if((t=r.sent()).error)throw new l(t.error);return[2,t]}})})}function d(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return t=[e,s].join("/"),[4,fetch(t)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}})})}t.ArcGisError=l,t.getServiceInfo=f,t.detectLayerMetadataSupport=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return[4,f(e)];case 1:return(t=r.sent()).supportedExtensions?[2,/LayerMetadata/.test(t.supportedExtensions)]:[2,!1]}})})},t.getLayerSources=d,t.getMetadataLinks=function(e,t){return o(this,void 0,void 0,function(){var r,n,a;return i(this,function(o){switch(o.label){case 0:return t?[3,2]:[4,d(e)];case 1:t=o.sent(),o.label=2;case 2:for(a in r=[e,c].join("/"),n={},t)n[a]=[r,t[a][0]].join("/");return[2,n]}})})},t.getValidLayers=function(e){return o(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return t=[e,u].join("/"),[4,fetch(t)];case 1:return[4,n.sent().json()];case 2:if((r=n.sent()).layerIds)return[2,r.layerIds];throw r.error?new l(r.error):new TypeError("response was not expected type: "+JSON.stringify(r))}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=n.__importDefault(r(8)),o=r(9);t.setOperationalLayers=function(e,t){var r,a;if(e&&window.URLSearchParams)try{for(var i=n.__values(t),u=i.next();!u.done;u=i.next()){var s=u.value;if(s.id&&e.has(s.id)){var c=e.get(s.id);if(c){var l=o.LayerSettings.parse(c);l?l.apply(s):console.warn('could not parse "'+c+'" into layer settings for layer '+s.id+".")}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}},t.createLayerLink=function(e){if(!(window.URL&&window.URLSearchParams&&window.history))throw new Error("Browser must support all of the following features: URL, URLSearchParams, history.");var t=document.createElement("div");t.classList.add("layer-link");var r=document.createElement("a");r.href=new URL(location.href,location.href.replace(/\?.+$/,"")).toString(),r.textContent="🔗",r.title="Click to update URL with layer and extent paramters.",r.target="_blank",r.classList.add("layer-link__anchor"),t.classList.add("layer-link--disabled"),t.appendChild(r);var n=e.map.on("extent-change",function(e){var n=e.extent,o=[(n=a.default.webMercatorToGeographic(n)).xmin,n.ymin,n.xmax,n.ymax].map(function(e){return Math.round(1e4*e)/1e4}).join(" "),i=new URL(r.href);i.searchParams.set("map-extent",o),r.href=i.toString(),t.classList.remove("layer-link--disabled"),t.classList.remove("layer-link--copied")}),i=e.on("toggle",function(n){console.group("LayerList toggle event"),t.classList.remove("layer-link--copied"),t.classList.remove("layer-link--disabled");var a=n.layerIndex,i=n.visible,u=n.subLayerIndex;console.debug("layer: "+a+", sublayer "+u+", visible: "+i);var s=e.layers[a],c=new URL(r.href),l=c.searchParams.get(s.id),f=l?o.LayerSettings.parse(l):null,d=(!!f&&f.visibleLayers,new o.LayerSettings({visible:s.visibility,visibleLayers:s.layer.visibleLayers}));c.searchParams.set(s.id,d.toString()),r.href=c.toString()});return r.onclick=function(e){if(window.history)return history.replaceState(void 0,document.title,r.href),t.classList.add("layer-link--copied"),!1},e.map.root.appendChild(t),{layerToggleHandle:i,extentChangeHandle:n,root:t}}},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),a=function(){function e(e){e&&(this.visible=e.visible,this.visibleLayers=e.visibleLayers)}return e.parse=function(t){var r,a=n.makeBooleanRe(!0,!1),o=n.makeBooleanRe(!1,!1),i=!!a.test(t)||!o.test(t)&&void 0,u=t.match(/\-?\d+/g);return u&&(r=u.map(function(e){return parseInt(e,10)})),void 0===i&&r&&(i=!0),null===i?null:new e({visible:i,visibleLayers:r})},e.prototype.apply=function(e){var t=e.layer;if(t){var r=t;r.suspend&&r.suspend(),null!=this.visible&&(e.visibility=this.visible,t.setVisibility(this.visible)),!1!==e.showSubLayers&&this.visibleLayers&&r.setVisibleLayers(this.visibleLayers),r.resume&&r.resume()}},e.prototype.toString=function(){var e=null==this.visible?"":this.visible?"✓":"⍻";return this.visibleLayers?[e].concat(this.visibleLayers.map(function(e){return e.toString(10)})).join(" "):e},e}();t.LayerSettings=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=["true","on","✓","✔","🗸","🗹","☑","✅"],o=["false","off","⍻","X"];function i(e,t){var r=e.map(function(e){return"(?:"+e+")"}).join("|");return t&&(r="^(?:"+r+")$"),new RegExp(""+r,"i")}t.makeReGroup=i,t.makeBooleanRe=function(e,t){return i(!0===e?a:!1===e?o:a.concat.apply(a,n.__spread(o)),t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=n.__importDefault(r(12)),o=n.__importDefault(r(13));function i(e){var t=e.layerType,r=e.url,n=e.options.id,i=n.replace(/[^a-z0-9]+/gi,"_"),u=e.options.visible||!1;return{id:i,layer:/Tiled/i.test(t)?new o.default(r,{id:i,visible:u}):new a.default(r,{id:i,visible:u}),showLegend:!0,showOpacitySlider:!0,title:n,visibility:u}}t.fromGeoportalLayers=function(e){var t,r;if(Array.isArray(e))return{groups:r,layers:t=e.map(i)};for(var n in t=new Array,r={},e)if(e.hasOwnProperty(n)){var a=e[n].map(i);a.forEach(function(e){return t.push(e)}),r[n]=a.map(function(e){return e.title})}return{groups:r,layers:t}}},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t){e.exports=u},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(1);function o(e){void 0===e&&(e=location.href);var t=/https?\:\/\/([^\.]+)\.github.io\/([^\/]+)/i,r=e.match(t);if(!r)throw new a.FormatError(e,t);var o=n.__read(r,3);return"https://www.github.com/"+o[1]+"/"+o[2]}t.ghPagesToGithubUrl=o,t.githubToGHPagesUrl=function(e){void 0===e&&(e=location.href);var t=/https?\:\/\/www.github.com\/([^\/]+)\/([^\/]+)/,r=e.match(t);if(!r)throw new a.FormatError(e,t);var o=n.__read(r,3);return"https://"+o[1]+".github.io/"+o[2]},t.createSourceLink=function(e){e=e||o();var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="nofollow";var r=document.createElement("span");return r.textContent="Source on GitHub",t.classList.add("github-link"),r.classList.add("github-link__label"),t.appendChild(r),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=n.__importDefault(r(22)),o="IYrj3otxNjPsrTRD";t.createWebmapIdForm=function(e){void 0===e&&(e="select");var t=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,new a.default.Portal("https://www.arcgis.com").queryItems({num:100,q:"orgid:"+o+' AND type:("Web Map" NOT "Application") AND tags:"geoportal"'})];case 1:return[2,e.sent().results]}})})}(),r=document.createElement("form");r.action=".",r.classList.add("webmapForm");var i,u,s,c=document.createElement("progress");r.appendChild(c),"select"===e?((i=document.createElement("select")).disabled=!0,i.innerHTML="<option disabled selected>change map</option>",i.name="webmap",r.appendChild(i)):((u=document.createElement("input")).name="webmap",u.id="webmapInput",u.type="text",u.required=!0,u.placeholder="ArcGIS webmap id",u.title="value must be hexadecimal webmap ID",u.pattern=/^[a-f0-9]+$/.source,(s=document.createElement("datalist")).id="webmapList",r.appendChild(u),r.appendChild(s),u.setAttribute("list",s.id));var l=document.createElement("button");return l.type="submit",l.textContent="change map",r.appendChild(l),t.then(function(e){(i||u).disabled=!1,e.forEach(function(e){var t=document.createElement("option");t.value=e.id,t.textContent=t.label=e.title,(i||s).appendChild(t)}),r.removeChild(c)},function(e){console.error("AGOL query error",e);var t=new CustomEvent("webmapqueryerror",{detail:{error:e}});r.dispatchEvent(t),r.removeChild(c)}),r}},function(e,t){e.exports=l}])});
//# sourceMappingURL=main.js.map